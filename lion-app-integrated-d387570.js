(window.webpackJsonpLoyaltyLionMain=window.webpackJsonpLoyaltyLionMain||[]).push([[1],{449:function(e,t,a){"use strict";function r(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}a.d(t,"b",function(){return r}),a.d(t,"a",function(){return n})},452:function(e,t,a){"use strict";a.d(t,"a",function(){return p}),a.d(t,"b",function(){return f}),a.d(t,"c",function(){return O});var r=a(1),n=a(2),c=a(8),i=a(10),o=a(63),l=a(21),s=a(36);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function u(e,t,a,r){switch(e.type){case"add":case"deduct":return(e.note?e.note[r]:null)||Object(c.d)("defaults.general.activity_reason");case"rule":var n=t.find(function(t){return t.id===e.ruleId});return n?n.displayTitle:"";case"reward":var i=a.find(function(t){return t.id===e.rewardId});return i?i.displayTitle:""}}function m(e){return"reward"===e.type?"-".concat(Object(c.c)(e.points)):"".concat(Object(c.c)(e.points))}function b(e,t,a,n){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(a,!0).forEach(function(t){Object(r.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},e,{displayPoints:m(e),actionText:u(e,t,a,n)})}var p=Object(n.createSelector)(i.j,function(e){return e?e.actions:[]}),f=Object(n.createSelector)(p,s.c,l.m,o.b,function(e,t,a,r){return e.map(function(e){return b(e,t,a,r)})}),O=Object(n.createSelector)(function(e,t){return t},f,function(e,t){return t.slice(0,e)})},453:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(68);function n(e){var t=e.incentive,a=e.currency,n=e.localCurrency;switch(t.discountKind){case"flat":return Object(r.a)(a,n,t.discountAmount);case"percentage":return"".concat(t.discountAmount,"%")}}},455:function(e,t,a){"use strict";function r(e){return e.refereeIncentiveCode}a.d(t,"a",function(){return r})},456:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var r=a(9),n=a(15),c=a(14),i=a(33),o=a(17),l=a(39),s=a(1),d=function(e){function t(){var e,a;Object(r.a)(this,t);for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return a=Object(n.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l))),Object(s.a)(Object(i.a)(a),"name","NoReferralRuleError"),a}return Object(o.a)(t,e),t}(Object(l.a)(Error))},504:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a.n(r),c=a(132),i=a(22),o=a(89),l=a(10),s=a(107),d=function(e){return n.a.createElement("div",{id:"loyaltylion"},e.children)};d.displayName="Isolator";var u=d,m=a(263),b=a.n(m),p=a(195),f=a.n(p),O=a(131),_=a(9),j=a(13),h=a(1),y=new(function(){function e(){Object(_.a)(this,e),Object(h.a)(this,"isIosDevice","undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iPad|iPhone|iPod|(iPad Simulator)|(iPhone Simulator)|(iPod Simulator)/.test(window.navigator.platform)),Object(h.a)(this,"firstTargetElement",null),Object(h.a)(this,"allTargetElements",{}),Object(h.a)(this,"initialClientY",-1),Object(h.a)(this,"previousBodyOverflowSetting",""),Object(h.a)(this,"previousDocumentElementOverflowSetting","")}return Object(j.a)(e,[{key:"disableBodyScroll",value:function(e){var t=this;this.isIosDevice?e&&(this.allTargetElements[e]=e,e.ontouchstart=function(e){1===e.targetTouches.length&&(t.initialClientY=e.targetTouches[0].clientY)},e.ontouchmove=function(a){1===a.targetTouches.length&&t.handleScroll(a,e)}):this.setOverflowHidden(),this.firstTargetElement||(this.firstTargetElement=e)}},{key:"clearAllBodyScrollLocks",value:function(){var e=this;this.isIosDevice?(Object.keys(this.allTargetElements).forEach(function(t){var a=e.allTargetElements[t];a.ontouchstart=null,a.ontouchmove=null,delete e.allTargetElements[t]}),this.initialClientY=-1):(this.setOverflowAuto(),this.firstTargetElement=null)}},{key:"enableBodyScroll",value:function(e){this.isIosDevice?(e.ontouchstart=null,e.ontouchmove=null):this.firstTargetElement===e&&(this.setOverflowAuto(),this.firstTargetElement=null)}},{key:"preventDefault",value:function(e){var t=e||window.event;return t.preventDefault&&t.preventDefault(),!1}},{key:"setOverflowHidden",value:function(){var e=this;setTimeout(function(){e.previousBodyOverflowSetting=document.body.style.overflow,e.previousDocumentElementOverflowSetting=document.documentElement.style.overflow,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"})}},{key:"setOverflowAuto",value:function(){var e=this;setTimeout(function(){document.body.style.overflow=e.previousBodyOverflowSetting||"",document.documentElement.style.overflow=e.previousDocumentElementOverflowSetting||""})}},{key:"isTargetElementTotallyScrolled",value:function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}},{key:"handleScroll",value:function(e,t){var a=e.targetTouches[0].clientY-this.initialClientY;return t&&0===t.scrollTop&&a>0?this.preventDefault(e):!(this.isTargetElementTotallyScrolled(t)&&a<0)||this.preventDefault(e)}}]),e}()),v=y;function E(e){y.disableBodyScroll(document.querySelector(e))}var g=function(e){var t=e.isLoyaltyModalOpen?n.a.createElement(b.a,{key:"1",classNames:{enter:Object(O.b)("loyalty-modal--enter"),enterActive:Object(O.b)("loyalty-modal--enter-active"),exit:Object(O.b)("loyalty-modal--exit"),exitActive:Object(O.b)("loyalty-modal--exit-active")},onEnter:function(){window.innerWidth<=600?E("#loyaltylion-loyalty-modal-screen"):E(".lion-loyalty-panel-content__overflow-container")},onExit:function(){v.clearAllBodyScrollLocks()},timeout:150},n.a.createElement("div",{className:Object(O.b)("loyalty-modal")},n.a.createElement("div",{id:"loyaltylion-loyalty-modal-screen",className:"".concat(Object(O.b)("screen","screen--dark"))},e.children))):null;return n.a.createElement(f.a,null,t)};g.displayName="LoyaltyModal";var w=Object(c.b)(function(e){return{isLoyaltyModalOpen:e.isLoyaltySplashOrPanelModalOpen}})(g),k=a(15),N=a(14),C=a(17),S=a(94),P=a(18),K=a(8),I=a(2),R=[{i18nKeyMenu:"ui.dashboard.menu.earn_points",i18nKeyTitle:"ui.dashboard.page_titles.earn",i18nKeyDescription:"ui.splash.earn_heading_personalised",id:"earn"},{i18nKeyMenu:"ui.dashboard.menu.redeem_points",i18nKeyTitle:"ui.dashboard.page_titles.redeem",i18nKeyDescription:"ui.splash.rewards_heading",id:"rewards"},{i18nKeyMenu:"ui.dashboard.menu.refer_friends",i18nKeyTitle:"ui.dashboard.page_titles.refer",id:"refer"},{i18nKeyMenu:"ui.dashboard.menu.tiers",i18nKeyTitle:"ui.dashboard.page_titles.tiers",id:"tiers"},{i18nKeyMenu:"ui.dashboard.menu.account",i18nKeyTitle:"ui.dashboard.page_titles.account",id:"history"},{i18nKeyMenu:"ui.dashboard.menu.help",i18nKeyTitle:"ui.dashboard.page_titles.help",id:"help"}],x=a(47),T=Object(I.createSelector)(x.d,function(e){return R.find(function(t){return t.id===e.currentPageId})||R[0]}),M=a(185),D=function(){return r.createElement("div",{className:Object(O.b)("loyalty-panel-content","loyalty-panel-content--blocked")},r.createElement("header",{className:Object(O.b)("loyalty-panel-content__header")},r.createElement(M.a,{i18nKey:"ui.blocked.sorry"})),r.createElement("div",{className:Object(O.b)("loyalty-panel-content__overflow-container")},r.createElement("p",null,r.createElement(M.a,{i18nKey:"ui.blocked.message"}))))},A=a(36),L=a(63),F=a(41),B=a(449),V=a(5),U=a(11),H=a(52),W=a(68),q=Object(c.b)(function(e){return{currency:Object(P.a)(e),localCurrency:Object(H.c)(e)}})(function(e){return n.a.createElement("div",{className:e.className||""},e.isPerUnit?n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.points_per",params:{smart_count:e.points,currency:Object(W.a)(e.currency,e.localCurrency,1)}}):n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:e.points}}))}),Y=a(44);var G=a(0),z=a.n(G),X=a(3),J=a(33),$=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleSignup",Object(X.a)(z.a.mark(function e(){var t;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.signup();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:"error"in t&&alert(Object(K.d)("ui.general.error"));case 6:case"end":return e.stop()}},e)}))),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"componentWillUnmount",value:function(){this.props.reset()}},{key:"render",value:function(){return this.props.customer?this.props.completed?n.a.createElement("div",{className:Object(O.b)("newsletter-signup-action")},n.a.createElement("div",{className:Object(O.b)("newsletter-signup-action__completed")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.newsletter_signup.success_text"}))):n.a.createElement("div",{className:Object(O.b)("newsletter-signup-action")},n.a.createElement("div",{className:Object(O.b)("newsletter-signup-action__help")},n.a.createElement(M.a,{i18nKey:"defaults.rules.newsletter_signup.description",params:{points_text:this.props.rule.valueText}})),n.a.createElement("div",{className:Object(O.b)("newsletter-signup-action__button-wrapper")},n.a.createElement("a",{onClick:this.handleSignup,className:Object(O.b)("action-button","newsletter-signup-action__button",this.props.isSubmitting?"action-button--loading":"")},n.a.createElement(M.a,{i18nKey:"defaults.rules.newsletter_signup.action_button_text"})))):null}}]),t}(n.a.Component),Z=Object(c.b)(function(e){return{customer:Object(l.j)(e),isSubmitSuccess:e.loyaltyPanel.customerNewsletterSignupSuccess,isSubmitting:e.loyaltyPanel.isCustomerNewsletterSignupSubmitting,submitError:e.loyaltyPanel.customerNewsletterSignupError}},function(e){return{reset:function(){return e(Object(U.l)())},signup:function(){var t=Object(X.a)(z.a.mark(function t(){return z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(Object(U.h)());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}})($),Q=a(88),ee=a(26),te=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"profileWindow",void 0),Object(h.a)(Object(J.a)(a),"profileWindowOpenedAt",void 0),Object(h.a)(Object(J.a)(a),"handleClick",function(){if(a.profileWindow=window.open(a.url,a.windowName,a.windowFeatures),Object(ee.j)())return a.props.onTrigger({username:a.props.username});a.profileWindow&&(a.profileWindowOpenedAt=(new Date).getTime(),a.watchForClose().catch(function(e){V.a.error("Could not watch ".concat(a.props.social_name," window"),{err:e})}))}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return this.props.completed?n.a.createElement("div",{className:Object(O.b)("".concat(this.props.social_name,"-follow__completed"))},this.displayText()):n.a.createElement("div",{className:Object(O.b)("".concat(this.props.social_name,"-follow__link"))},n.a.createElement("a",{onClick:this.handleClick,className:Object(O.b)("action-button","".concat(this.props.social_name,"-follow__button"))},n.a.createElement(M.a,{i18nKey:"ui.general.follow"})," @",this.props.username))}},{key:"componentWillUnmount",value:function(){this.profileWindow=null}},{key:"displayText",value:function(){return n.a.createElement(M.a,{i18nKey:"ui.general.following_thanks",params:{username:this.props.username,social_name:Object(B.a)(this.props.social_name)}})}},{key:"watchForClose",value:function(){var e=Object(X.a)(z.a.mark(function e(){var t,a;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.profileWindow){e.next=12;break}if(!this.profileWindow.closed){e.next=8;break}return this.profileWindow=null,t=this.profileWindowOpenedAt||0,a=(new Date).getTime(),a-t>3e3&&this.props.onTrigger({username:this.props.username}),e.abrupt("break",12);case 8:return e.next=10,Object(Q.a)(100);case 10:e.next=0;break;case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"url",get:function(){switch(this.props.social_name){case"twitter":return"https://twitter.com/".concat(this.props.username);case"instagram":return"https://www.instagram.com/".concat(this.props.username,"/")}}},{key:"windowFeatures",get:function(){return["width=500","height=500"].join(",")}},{key:"windowName",get:function(){switch(this.props.social_name){case"twitter":return"LION_TWITTER_PROFILE_PAGE";case"instagram":return"LION_INSTAGRAM_PROFILE_PAGE"}}}]),t}(n.a.Component);function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var re=function(e){var t=e.locale,a=e.openReferralWidget,r=e.openRuleModal,c=e.rule,i=e.trigger;if(c.completedForever)return n.a.createElement("div",{className:Object(O.b)("rule-item__completed-forever")});if(!function(e){return""!==e.actionButtonText}(c))return null;switch(c.kind){case"instagramFollow":return n.a.createElement(te,{completed:c.completedForever,onTrigger:i,username:c.properties.instagramHandle,social_name:"instagram"});case"twitterFollow":return n.a.createElement(te,{completed:c.completedForever,onTrigger:i,username:c.properties.twitterHandle,social_name:"twitter"});case"newsletterSignup":return n.a.createElement(Z,{completed:c.completedForever,rule:c});default:var o="referral"===c.kind?a:r,l=Object(A.u)(c)&&c.limitInterval?Object(A.a)(t,c.limitInterval):null;return n.a.createElement("div",{onClick:o,className:Object(O.b)("action-button","rule-item__button",{"rule-item__button--disabled":!c.actionable,"rule-item__button--limit-reached":c.limitReached&&Object(A.u)(c),"rule-item__button--completed-forever":c.completedForever})},!l&&c.actionButtonText,l&&n.a.createElement("div",{className:Object(O.b)("rule-item__limit-reached")},l))}};re.displayName="RuleItemActionButton";var ne=Object(c.b)(function(e){return{locale:Object(L.b)(e)}},function(e,t){var a=t.rule;return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({trigger:function(t){return e(Object(U.K)({id:a.id,properties:t}))},openRuleModal:function(){return e(Object(U.s)(a.id))}},Object(Y.bindActionCreators)({openReferralWidget:U.q},e))})(re),ce=function(e){var t,a=e.children,r=e.customer,c=e.mode,i=e.rule,o=e.style,l=Object(O.c)("rule-item",c);return n.a.createElement("div",{"data-rule-id":i.id,className:Object(O.a)("".concat(l),"".concat(l,"--").concat(Object(B.b)(i.kind)),"".concat(l,"--").concat(i.id),(t={},Object(h.a)(t,"".concat(l,"--style-").concat(o),Boolean(o)),Object(h.a)(t,"".concat(l,"--completed-forever"),i.completedForever),Object(h.a)(t,"".concat(l,"--actionable"),Boolean(r)&&i.actionable),Object(h.a)(t,"".concat(l,"--guest"),!r),Object(h.a)(t,"".concat(l,"--authenticated"),Boolean(r)),t))},a)};ce.displayName="RuleItemWrapper";var ie=a(25),oe=["1","legacy"];var le=function(e){var t=e.mode,a=e.ruleId,c=e.requestedStyle,i=Object(s.c)(function(e){return{customer:Object(l.j)(e),locale:Object(L.b)(e),rule:Object(A.o)(e,a),useLegacySdkStandaloneRuleStyle:Object(F.e)(e)}},[a]),o=i.customer,d=i.locale,u=i.rule,m=i.useLegacySdkStandaloneRuleStyle,b=Object(s.d)(),p=Object(r.useCallback)(function(){(function(e,t){return Boolean(e&&t&&t.actionable&&!t.completedForever)})(o,u)&&b(Object(U.s)(a))},[o,b,u,a]);if(!u)return null;var f=function(e,t,a){if("panel"===t)return null;if(""===e)return a?"legacy":"1";if(!function(e){return Object(ie.c)(oe,e)}(e))return V.a.warn("Unsupported rule style provided, please ensure data-lion-style ondata-lion-rules-list is one of ['legacy', '1']"),"1";return e}(c,t,m),_=Object(O.c)("rule-item",t);return n.a.createElement(ce,{customer:o,rule:u,mode:t,style:f},n.a.createElement("div",{onClick:se(f)?void 0:p,className:Object(O.a)("".concat(_,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(_,"__icon"),"icon","icon__rule--".concat(Object(B.b)(u.kind)))}),n.a.createElement("div",{className:Object(O.a)("".concat(_,"__title"))},u.displayTitle),n.a.createElement(q,{points:u.value,isPerUnit:u.isValuePerUnit,className:Object(O.a)("".concat(_,"__points"))}),function(e){return"legacy"===e||null===e}(f)&&Object(A.u)(u)&&n.a.createElement(de,{block:_,locale:d,rule:u}),function(e){return"legacy"===e||null===e}(f)&&u.completedForever&&n.a.createElement("div",{className:Object(O.a)("".concat(_,"__completed-forever"))}),se(f)&&o&&n.a.createElement(ne,{rule:u})))};function se(e){return"1"===e}le.displayName="RuleItem";var de=function(e){var t=e.block,a=e.locale,r=e.rule;return n.a.createElement("div",{className:Object(O.a)("".concat(t,"__limit-reached"))},r.limitInterval?Object(A.a)(a,r.limitInterval):null)};var ue=function(e){var t=e.mode,a=e.requestedStyle,r=void 0===a?"":a,c=e.className,i=void 0===c?"":c,o=Object(s.c)(function(e){return{ruleIds:Object(A.q)(e,t)}},[]).ruleIds,l="panel"===t?"loyalty-panel-page-earn__rules-list":"rules-list";return n.a.createElement("div",{className:Object(O.a)(l)+" ".concat(i)},o.map(function(e){return n.a.createElement(le,{key:e,mode:t,ruleId:e,requestedStyle:r})}))};ue.displayName="RulesList";var me=Object(c.b)(function(e,t){var a=t.siteId;return{ruleIds:Object(A.h)(e,a).map(function(e){return e.id}),site:Object(i.f)(e,a)}})(function(e){var t=e.site,a=e.siteId,r=e.ruleIds;if(!t)throw new Error("Could not find Site ".concat(a));return 0===r.length?null:n.a.createElement("div",{className:Object(O.a)("other-site-rules")},n.a.createElement("div",{className:Object(O.a)("other-site-rules__header")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.go_to_other_site.header",params:{store_name:t.name}})),n.a.createElement("div",{className:Object(O.a)("loyalty-panel-page-earn__rules-list")},r.map(function(e){return n.a.createElement(le,{key:e,mode:"panel",requestedStyle:"",ruleId:e})})))}),be=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.otherSiteIds;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-earn")},n.a.createElement(ue,{mode:"panel"}),e.map(function(e){return n.a.createElement(me,{key:e,siteId:e})}))}}]),t}(n.a.Component),pe=Object(c.b)(function(e){return{otherSiteIds:Object(i.g)(e).map(function(e){return e.id})}})(be),fe=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.helpContent;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-help")},n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-help__content"),dangerouslySetInnerHTML:{__html:e}}))}}]),t}(n.a.PureComponent),Oe=Object(c.b)(function(e){return{helpContent:Object(F.a)(e).helpContent}})(fe),_e=a(452),je=function(e){var t=e.pointState;switch(t){case"approved":return n.a.createElement(M.a,{i18nKey:"ui.general.approved"});case"declined":return n.a.createElement(M.a,{i18nKey:"ui.general.declined"});case"expired":return n.a.createElement(M.a,{i18nKey:"ui.general.expired"});case"pending":return n.a.createElement(M.a,{i18nKey:"ui.general.pending"});case"void":return n.a.createElement(M.a,{i18nKey:"ui.general.void"})}V.a.error("Invalid point state: ".concat(t," for history row"))},he=function(e){var t=e.className,a=void 0===t?"":t,r=e.mode,c=Object(s.c)(function(e){return{actions:Object(_e.b)(e)}},[]).actions;if(!c.length)return null;var i=Object(O.c)("history-table",r);return n.a.createElement("table",{className:Object(O.a)("".concat(i))+" ".concat(a)},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{"data-i18n-key":"ui.general.date",className:Object(O.a)("".concat(i,"__header-cell"))},n.a.createElement(M.a,{"data-i18n-key":"hello",i18nKey:"ui.general.date"})),n.a.createElement("th",{"data-i18n-key":"ui.general.type",className:Object(O.a)("".concat(i,"__header-cell"))},n.a.createElement(M.a,{i18nKey:"ui.general.type"})),n.a.createElement("th",{"data-i18n-key":"ui.general.action",className:Object(O.a)("".concat(i,"__header-cell"))},n.a.createElement(M.a,{i18nKey:"ui.general.action"})),n.a.createElement("th",{"data-i18n-key":"ui.general.points_plural",className:Object(O.a)("".concat(i,"__header-cell"))},n.a.createElement(M.a,{i18nKey:"ui.general.points_plural"})),n.a.createElement("th",{"data-i18n-key":"ui.general.status",className:Object(O.a)("".concat(i,"__header-cell"),"".concat(i,"__header-cell--centre-aligned"))},n.a.createElement(M.a,{i18nKey:"ui.general.status"})))),n.a.createElement("tbody",null,c.map(function(e){return n.a.createElement(ye,{action:e,block:i,key:e.id})})))};he.displayName="HistoryTable";var ye=function(e){var t=e.action,a=e.block;return n.a.createElement("tr",{key:t.id,className:Object(O.a)("".concat(a,"__row"))},n.a.createElement("td",{className:Object(O.a)("".concat(a,"__row-cell"),"".concat(a,"__row-date"))},Object(K.b)(new Date(t.date))),n.a.createElement("td",{"data-i18n-key":ve(t),className:Object(O.a)("".concat(a,"__row-cell"))},Object(K.d)(ve(t))),n.a.createElement("td",{className:Object(O.a)("".concat(a,"__row-cell")),dangerouslySetInnerHTML:{__html:t.actionText}}),n.a.createElement("td",{className:Object(O.a)("".concat(a,"__row-cell"))},t.displayPoints),n.a.createElement("td",{className:Object(O.a)("".concat(a,"__row-cell"),"".concat(a,"__row-status"))},n.a.createElement(Ee,{block:a,action:t})))};function ve(e){switch(e.type){case"add":case"deduct":return"ui.general.transaction";case"rule":return"ui.general.activity";case"reward":return"ui.general.reward_one"}}var Ee=function(e){var t=e.action,a=e.block,c=Object(s.d)(),i=Object(r.useCallback)(function(){c(Object(U.n)({type:"action",id:t.id}))},[t.id,c]);switch(t.type){case"add":case"deduct":return n.a.createElement("span",null,"-");case"rule":case"reward":return n.a.createElement("div",{onClick:i,className:Object(O.a)("".concat(a,"__bubble"),"history-state-bubble","history-state-bubble--".concat(t.state))},n.a.createElement(je,{pointState:t.state}))}},ge=Object(c.b)(null,function(e){return{onLinkClick:function(){return e(Object(U.a)("earn"))}}})(function(e){var t=e.onLinkClick;return n.a.createElement("div",{className:Object(O.b)("no-activities-help")},n.a.createElement("div",null,n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.no_activities_help"})),n.a.createElement("a",{href:"#",onClick:t,className:Object(O.b)("action-button")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.page_titles.earn"})))}),we=function(){var e=Object(s.c)(function(e){return{actions:Object(_e.b)(e)}},[]).actions;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-history")},e.length?n.a.createElement(he,{mode:"panel"}):n.a.createElement(ge,null))};we.displayName="History";var ke=a(84),Ne=a(58),Ce=a(95),Se=a(191),Pe=a(83),Ke=a(453),Ie=a(226),Re=function(e){if(!(e=e.trim()).length)return[];var t;if(e.match(/,/)){if(e.match(";"))return[];t=e.split(",")}else if(e.match(/;/)){if(e.match(","))return[];t=e.split(";")}else t=e.split(" ");return t.map(function(e){return e.trim()}).filter(function(e){return e.match(/^[^@,; ]+@[^@,; ]+$/)})},xe=a(128);function Te(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Me=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"handleClose",function(){a.props.submitting||a.props.onClose()}),Object(h.a)(Object(J.a)(a),"handleSubmit",function(){var e=Object(X.a)(z.a.mark(function e(t){var r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!a.props.submitting&&!a.props.submitSuccess){e.next=3;break}return e.abrupt("return");case 3:if(a.formFields.every(function(e){return a.validate(e)})){e.next=6;break}return a.setState({touched:!0}),e.abrupt("return");case 6:return r=a.props.formValues,a.setState({touched:!1}),e.next=10,a.props.submit({message:r.message,name:r.name,recipients:Re(r.recipients)});case 10:return e.next=12,Object(Q.a)(2500);case 12:a.props.reset();case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),Object(h.a)(Object(J.a)(a),"setFieldValues",function(e){a.setState({touched:!0}),a.props.setValues(e)}),Object(h.a)(Object(J.a)(a),"setRecipients",function(e){e.persist(),a.setFieldValues({recipients:e.target.value})}),Object(h.a)(Object(J.a)(a),"setName",function(e){e.persist(),a.setFieldValues({name:e.target.value.slice(0,50)})}),Object(h.a)(Object(J.a)(a),"setMessage",function(e){e.persist(),a.setFieldValues({message:e.target.value.slice(0,1e3)})}),a.state={touched:!1},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(e)!==JSON.stringify(this.props)}},{key:"validate",value:function(e){switch(e){case"message":return this.props.formValues.message.length>=5;case"name":return this.props.formValues.name.length>=1;case"recipients":return Re(this.props.formValues.recipients).length>=1}}},{key:"render",value:function(){return n.a.createElement("form",{onSubmit:this.handleSubmit,className:Object(O.b)("referral-email-form")},n.a.createElement("div",{className:Object(O.b)("referral-email-form__field")},n.a.createElement("label",{className:Object(O.b)("referral-email-form__label")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.recipients"})),n.a.createElement("input",{type:"input",name:"recipients",placeholder:"alice@example.com, james@example.com",className:Object(O.b)("referral-email-form__input",{"referral-email-form__input--error":this.touched&&!this.validate("recipients")}),value:this.props.formValues.recipients,onChange:this.setRecipients})),n.a.createElement("div",{className:Object(O.b)("referral-email-form__field")},n.a.createElement("label",{className:Object(O.b)("referral-email-form__label")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.your_name"})),n.a.createElement("input",{type:"input",name:"name",className:Object(O.b)("referral-email-form__input",{"referral-email-form__input--error":this.touched&&!this.validate("name")}),value:this.props.formValues.name,onChange:this.setName})),n.a.createElement("div",{className:Object(O.b)("referral-email-form__field")},n.a.createElement("label",{className:Object(O.b)("referral-email-form__label")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.message_label"})),n.a.createElement("textarea",{name:"message",className:Object(O.b)("referral-email-form__input","referral-email-form__textarea",{"referral-email-form__input--error":this.touched&&!this.validate("message")}),value:this.props.formValues.message,onChange:this.setMessage})),n.a.createElement("div",{className:Object(O.b)("referral-email-form__buttons")},n.a.createElement("button",{type:"submit",className:Object(O.b)("action-button",this.props.submitting?"action-button--loading":"","referral-email-form__button","referral-email-form__submit-button")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.send_btn"})),n.a.createElement("button",{"data-testid":"refer-email-form__back-button",className:Object(O.b)("action-button","action-button--neutral","referral-email-form__button"),type:"button",onClick:this.handleClose},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.back_btn"})),n.a.createElement("div",{className:Object(O.b)("referral-email-form__success-message",{"referral-email-form__success-message--visible":this.props.submitSuccess})},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.emails_sent"}))))}},{key:"componentDidMount",value:function(){this.props.setValues({message:this.formValues.message||this.props.emailContent,name:this.formValues.name||this.props.firstName})}},{key:"touched",get:function(){return this.state.touched}},{key:"formValues",get:function(){return this.props.formValues}},{key:"formFields",get:function(){return Object.keys(this.props.formValues)}}]),t}(n.a.Component),De=Object(c.b)(function(e){return{firstName:Object(l.d)(e).firstName,emailContent:Object(P.c)(e),formValues:e.referralWidget.emailForm.values,touched:e.referralWidget.emailForm.touched,submitting:e.referralWidget.emailForm.submitting,submitSuccess:e.referralWidget.emailForm.submitSuccess}},function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Te(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Te(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({setValues:xe.a,reset:xe.e},e),{submit:function(){var t=Object(X.a)(z.a.mark(function t(a){return z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(Object(xe.b)(a)));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()})})(Me),Ae=a(73),Le=a(45),Fe=function(e){var t=e.type,a=e.href,r=e.target,c=e.onClick,i=e.buttonTextKey,o={onClick:c,href:a,target:r};return n.a.createElement("a",Object(Ae.a)({},o,{className:Object(O.b)("referral-share-button","referral-share-button--".concat(t))}),n.a.createElement(M.a,{i18nKey:i}))},Be=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleClick",function(){Object(Ne.c)({location:"facebook",campaign_id:a.props.referralCampaignId}),Object(ee.j)()||a.props.sendMessage()}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isFacebookSdkReady,a=e.mobileShareUrl,r={type:"facebook-messenger",buttonTextKey:"sdk.referral_share_buttons.facebook_messenger"};return Object(ee.j)()?n.a.createElement(Fe,Object(Ae.a)({onClick:this.handleClick,href:a},r)):t?n.a.createElement(Fe,Object(Ae.a)({onClick:this.handleClick},r)):null}}]),t}(n.a.PureComponent);var Ve=Object(c.b)(function(e){var t,a,r,n;return{mobileShareUrl:(a={link:Object(Pe.a)(e).facebook,appId:null!==(t=Object(i.e)(e))&&void 0!==t?t:Le.a.loyaltylionFacebookAppId},r=encodeURIComponent(a.link),n=encodeURIComponent(a.appId),"fb-messenger://share?link=".concat(r,"&app_id=").concat(n)),isFacebookSdkReady:"ready"===Object(Ce.a)(e).sdkState,referralCampaignId:Object(Pe.c)(e)}},function(e,t){return{sendMessage:function(){return e(Object(ke.a)("send",t.referralUrl))}}})(Be),Ue=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleClick",function(){Object(Ne.c)({campaign_id:a.props.referralCampaignId,location:"facebook"}),a.props.facebookShare()}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return this.props.isFacebookSdkReady?n.a.createElement(Fe,{onClick:this.handleClick,type:"facebook",buttonTextKey:"sdk.referral_share_buttons.facebook_share"}):null}}]),t}(n.a.PureComponent),He=Object(c.b)(function(e){return{isFacebookSdkReady:"ready"===Object(Ce.a)(e).sdkState,referralCampaignId:Object(Pe.c)(e)}},function(e,t){return{facebookShare:function(){return e(Object(ke.a)("share",t.referralUrl))}}})(Ue),We=function(e){return function(){Object(Ne.c)({campaign_id:e,location:"whatsapp"})}};var qe=Object(c.b)(function(e,t){return{shareContent:(a=t.referralUrl,r=Object(P.h)(e),"https://api.whatsapp.com/send?text=".concat(encodeURIComponent("".concat(r," ").concat(a)))),referralCampaignId:Object(Pe.c)(e)};var a,r},{})(function(e){var t=e.referralCampaignId,a=e.shareContent;return n.a.createElement(Fe,{href:a,target:"_blank",type:"whatsapp",buttonTextKey:"sdk.referral_share_buttons.whatsapp",onClick:We(t)})}),Ye=a(190),Ge=a.n(Ye),ze=a(438),Xe=a.n(ze),Je=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"clickClassTimeout",void 0),Object(h.a)(Object(J.a)(a),"ref",void 0),a.ref=n.a.createRef(),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"copyText",value:function(){var e=Object(X.a)(z.a.mark(function e(t){var a,r=this;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="error",e.next=3,Xe()(t).then(function(){a="success"}).catch(function(){a="error"});case 3:if(this.ref.current){e.next=5;break}return e.abrupt("return");case 5:this.ref.current.classList.add(Object(O.b)("copy-to-clipboard-button--".concat(a))),"number"==typeof this.clickClassTimeout&&window.clearTimeout(this.clickClassTimeout),this.clickClassTimeout=window.setTimeout(function(){r.ref.current&&r.ref.current.classList.remove(Object(O.b)("copy-to-clipboard-button--".concat(a)))},1500);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.a.createElement("button",{ref:this.ref,className:Ge()(Object(O.b)("copy-to-clipboard-button")),onClick:function(){return e.copyText(e.props.clipboardText)},title:"Copy to clipboard"})}}]),t}(n.a.Component);function $e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Ze=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"handlers",void 0),Object(h.a)(Object(J.a)(a),"trackReferralClick",function(e){return function(){var t=a.props.referralCampaignId;Object(Ne.c)({campaign_id:t,location:e})}}),Object(h.a)(Object(J.a)(a),"showEmailForm",function(){a.setState({isEmailFormOpen:!0})}),Object(h.a)(Object(J.a)(a),"hideEmailForm",function(){a.setState({isEmailFormOpen:!1})}),a.state={isEmailFormOpen:!1},a.handlers={},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.format&&"modal"!==this.props.format?"format-panel":"format-modal",t=this.props.referralUrls.direct;return n.a.createElement("div",{className:Object(O.b)("referral-widget","referral-widget--".concat(e))},n.a.createElement("div",{className:Object(O.b)("referral-widget-panels",this.state.isEmailFormOpen?"referral-widget-panels--slide":"")},n.a.createElement("div",{className:Object(O.b)("referral-widget-panel","referral-widget-main")},n.a.createElement("div",{className:Object(O.b)("referral-widget-main__icon")}),n.a.createElement("div",{className:Object(O.b)("referral-widget-main__intro")},this.introText),n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-controls")},n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-buttons")},n.a.createElement("a",{href:this.getTwitterShareUrl(),onClick:this.trackReferralClick("twitter"),target:"_blank",rel:"noopener noreferrer",className:Object(O.b)("referral-share-button","referral-share-button--twitter")},n.a.createElement(M.a,{i18nKey:"sdk.referral_share_buttons.twitter"})),this.renderReferralsAdvancedSharing(),n.a.createElement(He,{referralUrl:this.props.referralUrls.facebook}),n.a.createElement("a",{className:Object(O.b)("referral-share-button","referral-share-button--email"),onClick:this.showEmailForm},n.a.createElement(M.a,{i18nKey:"sdk.referral_share_buttons.email"}))),n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-link")},n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-link-text")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.link_text"})),n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-link-container")},n.a.createElement("div",{className:Object(O.b)("referral-widget-main__share-link-url"),style:{textTransform:"none"},onClick:this.trackReferralClick("direct")},t),n.a.createElement(Je,{onClick:this.trackReferralClick("direct"),clipboardText:t}))))),n.a.createElement("div",{className:Object(O.b)("referral-widget-panel","referral-widget-email-form")},n.a.createElement(De,{onClose:this.hideEmailForm}))))}},{key:"bindTwitterHandlers",value:function(){!this.handlers.twitter&&this.twitterSDK&&(this.handlers.twitter={tweet:this.onTweetStart.bind(this)},this.twitterSDK.events.bind("tweet",this.handlers.twitter.tweet))}},{key:"unbindTwitterHandlers",value:function(){this.handlers.twitter&&this.twitterSDK&&this.handlers.twitter.tweet&&this.twitterSDK.events.unbind("tweet",this.handlers.twitter.tweet)}},{key:"componentDidMount",value:function(){"initial"===this.props.twitterSDKState?this.props.loadTwitterSDK():"ready"===this.props.twitterSDKState&&this.bindTwitterHandlers(),"initial"===this.props.facebookSDKState&&this.props.loadFacebookSDK()}},{key:"componentWillReceiveProps",value:function(e){"ready"!==this.props.twitterSDKState&&"ready"===e.twitterSDKState&&this.bindTwitterHandlers()}},{key:"componentWillUnmount",value:function(){this.unbindTwitterHandlers(),this.props.facebookHasMerchantAppId||this.props.resetFacebookSdkState()}},{key:"onTweetStart",value:function(){this.props.trackReferralShare({referralId:Object(Ie.a)(this.props.referralUrls.twitter)})}},{key:"getTwitterShareUrl",value:function(){var e=this.props.referralUrls.twitter,t=this.props.siteTweetContent.slice(0,140-(e.length+1));return"https://twitter.com/intent/tweet"+"?text=".concat(encodeURIComponent(t))+"&url=".concat(encodeURIComponent(e))}},{key:"renderReferralsAdvancedSharing",value:function(){return this.props.referralsAdvancedSharingEnabled?n.a.createElement(n.a.Fragment,null,n.a.createElement(qe,{referralUrl:this.props.referralUrls.whatsapp}),n.a.createElement(Ve,{referralUrl:this.props.referralUrls.facebook})):null}},{key:"introText",get:function(){var e=this.props,t=e.refereeIncentiveSettings,a=e.firstReferralRule,r=e.currency,c=e.localCurrency;if(!a)return"";var i=Object(K.d)("ui.general.points_count_raw",{smart_count:a.value}),o=Object(W.a)(r,c,a.properties.qualifyingPurchaseAmount);if(!t)return n.a.createElement(M.a,{i18nKey:"ui.referral_popup.intro_no_offer",params:{points:i,amount:o}});switch(t.kind){case"cart_discount":var l=Object(Ke.a)({incentive:t,currency:r,localCurrency:c});return n.a.createElement(M.a,{i18nKey:"ui.referral_popup.intro_with_offer",params:{points:i,discount:l,amount:o}});case"free_shipping":return n.a.createElement(M.a,{i18nKey:"ui.referral_popup.intro_free_shipping_offer",params:{points:i,amount:o}})}}},{key:"twitterSDK",get:function(){return window.twttr}}]),t}(n.a.Component);Object(h.a)(Ze,"displayName","ReferralWidget");var Qe=Object(c.b)(function(e){var t=Object(Pe.c)(e),a=t?Object(Pe.b)(e,t):Object(Pe.a)(e);return{currency:Object(P.a)(e),localCurrency:Object(H.c)(e),currentLocale:Object(L.b)(e),facebookSDKState:Object(Ce.a)(e).sdkState,facebookHasMerchantAppId:Boolean(Object(i.e)(e)),firstReferralRule:Object(A.e)(e),referralCampaignId:t,refereeIncentiveSettings:Object(Se.a)(e),referralUrls:a,siteName:Object(P.b)(e).name,siteTweetContent:Object(P.h)(e),twitterSDKState:e.integrations.twitterSDK,referralsAdvancedSharingEnabled:Object(i.a)(e).referralsAdvancedSharing}},function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$e(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$e(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({loadTwitterSDK:ke.c,trackReferralShare:Ne.b},e),{loadFacebookSDK:function(){return e(Object(ke.b)("share"))},resetFacebookSdkState:function(){return e(Object(ke.d)("initial"))}})})(Ze),et=Object(c.b)(function(e){var t=Object(F.a)(e).urls;return{loginURL:t.login,signupURL:t.signup}})(function(e){var t=e.format,a=void 0===t?"modal":t,r=e.loginURL,c=e.signupURL;return n.a.createElement("div",{className:Object(O.b)("referral-widget","referral-widget--format-".concat(a))},"modal"===a&&n.a.createElement("div",{className:Object(O.b)("referral-widget__header","modal__header")},n.a.createElement("div",{className:Object(O.b)("referral-widget__title--guest","modal__title")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.header"}))),n.a.createElement("div",{className:Object(O.b)("referral-widget-needs-auth")},n.a.createElement("div",{className:Object(O.b)("referral-widget-needs-auth__help")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.please_log_in_or_signup"})),n.a.createElement("div",{className:Object(O.b)("referral-widget-needs-auth__buttons")},n.a.createElement("a",{href:r,className:Object(O.b)("action-button")},n.a.createElement(M.a,{i18nKey:"ui.splash.login"})),n.a.createElement("span",{className:Object(O.b)("referral-widget-needs-auth__button-spacer")},"/"),n.a.createElement("a",{href:c,className:Object(O.b)("action-button")},n.a.createElement(M.a,{i18nKey:"ui.splash.signup"})))))}),tt=Object(c.b)(function(e){return{customer:Object(l.j)(e)}})(function(e){return e.customer?n.a.createElement(Qe,{format:"panel"}):n.a.createElement(et,null)}),at=a(108),rt=a(431),nt=a(188),ct=a(187),it=function(e){var t=e.claimedRewardId,a=e.mode,c=Object(s.c)(function(e){return{claimedReward:Object(at.c)(e,t),locale:Object(L.b)(e)}},[t]),i=c.claimedReward,o=c.locale,l=Object(s.d)(),d=Object(r.useCallback)(function(){l(Object(U.n)({id:t,type:"claimedReward"}))},[t,l]);if(!i)throw new nt.a("ClaimedRewardItem needs a ClaimedReward");var u=Object(O.c)("claimed-reward-item",a),m=i.createdAt,b=i.displayTitle,p=i.usedAt;return n.a.createElement("div",{className:Object(O.a)(u)},n.a.createElement("div",{className:Object(O.a)("".concat(u,"__left"))},n.a.createElement("div",{className:Object(O.a)("".concat(u,"__title")),dangerouslySetInnerHTML:{__html:b}}),n.a.createElement("div",{className:Object(O.a)("".concat(u,"__date"))},Object(rt.a)(new Date(m),new Date,{addSuffix:!0,locale:Object(ct.a)(o)}))),n.a.createElement("div",{className:Object(O.a)("".concat(u,"__right"))},p?n.a.createElement(ot,{block:u,usedAt:p,locale:o}):n.a.createElement(lt,{block:u,openInfoModal:d})))};it.displayName="ClaimedRewardItem";var ot=function(e){var t=e.usedAt,a=e.block,r=e.locale;return n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.reward_used_ago",className:Object(O.a)("".concat(a,"__view-reward-button"),"action-button","action-button--disabled","action-button--fixed-width")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.reward_used_ago",params:{time_ago:Object(rt.a)(new Date(t),new Date,{addSuffix:!0,locale:Object(ct.a)(r)})}}))},lt=function(e){var t=e.block,a=e.openInfoModal;return n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.view_reward",onClick:a,className:Object(O.a)("".concat(t,"__view-reward-button"),"action-button","action-button--fixed-width")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_reward"}))},st=function(e){var t=e.mode,a=e.showUsed,r=void 0===a||a,i=Object(c.c)(at.d),o=Object(c.c)(at.h);if(!Boolean(Object(c.c)(l.j)))return null;var s=r?i:o,d="panel"===t?"loyalty-panel-page-rewards__claimed-rewards-list":"claimed-rewards-list",u=0===s.length;return n.a.createElement("div",{"data-i18n-key":u?"ui.dashboard.redeem_points.no_rewards":null,className:Object(O.a)(d,u&&"".concat(d,"--empty ").concat(d,"--no-items"))},u?n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.no_rewards"}):s.map(function(e){return n.a.createElement(it,{mode:t,key:e,claimedRewardId:e})}))};st.displayName="ClaimedRewardsList";var dt=function(e){var t=e.mode,a=Object(s.e)(Object(r.useCallback)(function(e){var t=Object(l.j)(e);return{hasCustomer:Boolean(t),pointsApproved:t?Object(l.c)(e):0,pointsPending:t?t.pointsPending:0}},[])),c=a.hasCustomer,i=a.pointsPending,o=a.pointsApproved,d=Object(s.d)(),u=Object(r.useCallback)(function(){return d(Object(U.o)())},[d]);if(!c)return null;if(i<=0)return null;var m=Object(O.c)("rewards",t);return n.a.createElement("div",{className:Object(O.b)("".concat(m,"__points-explain-box"))},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.redeemable_points",className:Object(O.b)("".concat(m,"__points-explain-box-redeemable"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.redeemable_points",params:{points:Object(K.d)("ui.general.points_count",{smart_count:o})}})),n.a.createElement("div",{className:Object(O.b)("".concat(m,"__points-explain-box-pending"))},n.a.createElement("a",{"data-i18n-key":"ui.dashboard.redeem_points.why_not_all",className:Object(O.b)("".concat(m,"__points-explain-box-pending-link")),onClick:u},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.why_not_all"}))))},ut=a(21),mt=function(e){var t=e.children,a=e.disabled,r=e.onClick,c=e.mode,i=Object(O.c)("reward-item",c);return n.a.createElement("div",{"data-testid":"redeem-reward-button",className:Object(O.a)("action-button","".concat(i,"__redeem-button"),a&&"".concat(i,"__redeem-button--disabled")),onClick:a?void 0:r},t)},bt=function(e){var t=e.approvedPoints,a=e.claimClick,r=e.disabledAlreadyRedeemed,c=e.disabledGeneric,i=e.mode,o=e.outOfStock,l=e.paidItemsRequired,s=e.rewardCost,d="integrated"===i?"loyalty-page-reward-item__redeem-button-text":"",u=Object(O.c)("reward-item",i);return r?n.a.createElement(mt,{disabled:!0,mode:i},n.a.createElement("span",{"data-i18n-key":"sdk.seamless_product_reward.already_redeemed",className:Object(O.a)("".concat(u,"__redeem-button-text"),d)},n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.already_redeemed"}))):o?n.a.createElement(mt,{disabled:!0,mode:i},n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.out_of_stock",className:Object(O.a)("".concat(u,"__redeem-button-text"),d)},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.out_of_stock"}))):t>=s?l?n.a.createElement(mt,{disabled:!0,mode:i},n.a.createElement("span",{"data-i18n-key":"sdk.seamless_product_reward.paid_items_required",className:Object(O.a)("".concat(u,"__redeem-button-text"),d)},n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.paid_items_required"}))):n.a.createElement(mt,{disabled:Boolean(c),mode:i,onClick:c?void 0:function(){return a()}},n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.get_reward",className:Object(O.a)("".concat(u,"__redeem-button-text"),d)},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.get_reward"}))):n.a.createElement(mt,{disabled:!0,mode:i},n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.more_points_needed",className:Object(O.a)("".concat(u,"__redeem-button-text"),d)},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.more_points_needed",params:{total_cost:s}})),n.a.createElement("div",{className:Object(O.a)("".concat(u,"__fill")),style:{width:"".concat(t/s*100,"%")}}))},pt=function(e){var t=e.children,a=e.id,r=e.kind,c=e.mode,i=Object(s.c)(function(e){return{hasCustomer:Boolean(Object(l.j)(e))}},[]).hasCustomer,o=Object(O.c)("reward-item",c);return n.a.createElement("div",{className:Object(O.a)("".concat(o),"".concat(o,"--").concat(Object(B.b)(r)),"".concat(o,"--").concat(i?"customer":"guest")),"data-reward-id":a},t)};pt.displayName="RewardItemWrapper";var ft=function(e){var t=e.mode,a=e.reward,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{currency:Object(P.a)(e),localCurrency:Object(H.c)(e),customer:t,pointsApproved:t?Object(l.c)(e):0}},[]),i=c.currency,o=c.localCurrency,d=c.customer,u=c.pointsApproved,m=Object(s.d)(),b=Object(r.useCallback)(function(){m(Object(U.p)(a.id))},[m,a.id]),p=Object(O.c)("reward-item",t);return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(p,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(p,"__title")),dangerouslySetInnerHTML:{__html:a.displayTitle}}),n.a.createElement("div",{className:Object(O.a)("".concat(p,"__meta"))},n.a.createElement("span",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(p,"__cost"))},n.a.createElement("span",null,n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:a.cost}}))),a.options.discountMinimumSpend&&a.options.discountMinimumSpend>0?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.voucher_meta_min_spend",className:Object(O.a)("".concat(p,"__min-spend"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_meta_min_spend",params:{amount:Object(W.a)(i,o,a.options.discountMinimumSpend)}}))):null),d&&n.a.createElement(bt,{mode:t,outOfStock:!a.inStock,approvedPoints:u,claimClick:b,rewardCost:a.cost})))};ft.displayName="CartDiscountVoucherItem";var Ot=function(e){var t=e.mode,a=e.reward,r=Object(s.c)(function(e){return{currency:Object(P.a)(e),localCurrency:Object(H.c)(e)}},[]),c=r.currency,i=r.localCurrency,o=Object(O.c)("reward-item",t);return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(o,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(o,"__title"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.checkout_redemption_short_message"})),n.a.createElement("div",{className:Object(O.a)("".concat(o,"__meta"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.checkout_redemption_points",params:{points:a.options.pointsPerUnit,unit:Object(W.a)(c,i,1)}}))))};Ot.displayName="CheckoutRedemptionItem";var _t=a(48),jt=function(e){var t=e.mode,a=e.reward,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{approvedPoints:t?Object(l.c)(e):0,customer:t}},[]),i=c.approvedPoints,o=c.customer,d=Object(s.d)(),u=Object(r.useCallback)(function(){d(Object(U.p)(a.id))},[d,a.id]),m=Object(r.useCallback)(function(){d(Object(U.r)(a.id))},[d,a.id]),b=Object(_t.g)(a),p=Object(_t.f)(a),f=Object(O.c)("reward-item",t);return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__title"))},a.displayTitle),n.a.createElement("div",{className:Object(O.a)("".concat(f,"__meta"))},"percentage"===a.options.discountType&&n.a.createElement(ht,{reward:a,mode:t}),n.a.createElement("span",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(f,"__cost"))},n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:a.cost}}))),n.a.createElement("div",{className:Object(O.a)("".concat(f,"__links"))},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__more-info-url"))},p&&n.a.createElement("a",{"data-i18n-key":"ui.dashboard.redeem_points.view_collection",href:a.options.collectionUrl},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_collection"}))),b&&n.a.createElement("div",{className:Object(O.a)("".concat(f,"__terms-url"))},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.terms_and_conditions_title",onClick:m},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.terms_and_conditions_title"})))),o&&n.a.createElement(bt,{mode:t,outOfStock:!a.inStock,approvedPoints:i,claimClick:u,rewardCost:a.cost})))};jt.displayName="CollectionDiscountVoucherItem";var ht=function(e){var t=e.mode,a=e.reward,r=Object(O.c)("reward-item",t);return n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.collection_percent_off",className:Object(O.a)("".concat(r,"__percent-off"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.collection_percent_off",params:{discount:"".concat(a.options.discountAmount,"%")}}))},yt=function(e){var t=e.mode,a=e.reward,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{approvedPoints:t?Object(l.c)(e):0,customer:t}},[]),i=c.approvedPoints,o=c.customer,d=Object(s.d)(),u=Object(r.useCallback)(function(){d(Object(U.p)(a.id))},[d,a.id]),m=Object(r.useCallback)(function(){d(Object(U.r)(a.id))},[d,a.id]),b=Object(O.c)("reward-item",t);return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(b,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(b,"__title"))},a.displayTitle),n.a.createElement("div",{className:Object(O.a)("".concat(b,"__meta"))},n.a.createElement("div",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(b,"__cost"))},n.a.createElement("span",null,n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:a.cost}})))),"panel"===t?n.a.createElement(vt,{block:b,onClick:m}):n.a.createElement(Et,{block:b,onClick:m}),o&&n.a.createElement(bt,{mode:t,outOfStock:!a.inStock,approvedPoints:i,claimClick:u,rewardCost:a.cost})))};yt.displayName="CustomRewardItem";var vt=function(e){var t=e.block,a=e.onClick;return n.a.createElement("div",{className:Object(O.a)("".concat(t,"__links"))},n.a.createElement("div",{className:Object(O.a)("".concat(t,"__more-info-url"))},n.a.createElement("a",{href:"#",onClick:a},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.more_information"}))))},Et=function(e){var t=e.block,a=e.onClick;return n.a.createElement("div",{className:Object(O.a)("".concat(t,"__links"))},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.more_information",onClick:a,className:Object(O.a)("".concat(t,"__more-info-url"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.more_information"})))},gt=function(e){var t=e.reward,a=e.mode,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{approvedPoints:t?Object(l.c)(e):0,customer:t}},[]),i=c.approvedPoints,o=c.customer,d=Object(s.d)(),u=Object(r.useCallback)(function(){d(Object(U.p)(t.id))},[d,t.id]),m=Object(O.c)("reward-item",a);return n.a.createElement(pt,{mode:a,id:t.id,kind:t.kind},n.a.createElement("div",{className:Object(O.a)("".concat(m,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(m,"__title"))},t.displayTitle),n.a.createElement("div",{className:Object(O.a)("".concat(m,"__meta"))},n.a.createElement("div",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(m,"__cost"))},n.a.createElement("span",null,n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:t.cost}})))),o&&n.a.createElement(bt,{mode:a,outOfStock:!t.inStock,approvedPoints:i,claimClick:u,rewardCost:t.cost})))};gt.displayName="FreeShippingVoucherItem";var wt=function(e){var t=e.mode,a=e.reward,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{customer:t,pointsApproved:t?Object(l.c)(e):0}},[]),i=c.customer,o=c.pointsApproved,d=Object(s.d)(),u=Object(r.useCallback)(function(){d(Object(U.p)(a.id))},[d,a.id]),m=Object(O.c)("reward-item",t);return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(m,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(m,"__title")),dangerouslySetInnerHTML:{__html:a.displayTitle}}),n.a.createElement("div",{className:Object(O.a)("".concat(m,"__meta"))},n.a.createElement("div",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(m,"__cost"))},n.a.createElement("span",null,n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:a.cost}})))),i&&n.a.createElement(bt,{mode:t,outOfStock:!a.inStock,approvedPoints:o,claimClick:u,rewardCost:a.cost})))};wt.displayName="GiftCardRewardItem";var kt=a(30),Nt=function(e){var t=e.mode,a=e.reward,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{redeemError:Object(x.e)(e,a.id),approvedPoints:t?Object(l.c)(e):0,buyWithPointsStatus:Object(H.b)(e),customer:t,disabledAlreadyRedeemed:Object(kt.b)(e,a.id),disabledPaidItemsRequired:Object(i.k)(e)&&!Object(kt.i)(e),outOfStock:Object(kt.e)(e,a.id)}},[a.id]),o=c.redeemError,d=c.approvedPoints,u=c.buyWithPointsStatus,m=c.customer,b=c.disabledAlreadyRedeemed,p=c.disabledPaidItemsRequired,f=c.outOfStock,_=Object(s.d)(),j=Object(r.useCallback)(function(){_(Object(U.p)(a.id))},[_,a.id]),h=Object(r.useCallback)(function(){_(Object(U.r)(a.id))},[_,a.id]),y=Object(O.c)("reward-item",t),v=a.options.productImageUrl&&a.options.productImageUrl.length>0,E=o&&Object(_t.e)(o.name)||"started"!==u;return n.a.createElement(pt,{mode:t,id:a.id,kind:a.kind},n.a.createElement("div",{className:Object(O.a)("".concat(y,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(y,"__title"))},a.displayTitle),n.a.createElement("div",{className:Object(O.a)("".concat(y,"__meta"))},n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.product_percent_off"},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.product_percent_off",params:{discount:"".concat(a.options.discountAmount,"%")}})),n.a.createElement("span",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(y,"__cost"))},n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:a.cost}}))),v&&n.a.createElement(Ct,{reward:a,mode:t}),n.a.createElement("div",{className:Object(O.a)("".concat(y,"__links"))},n.a.createElement(St,{reward:a,mode:t}),Object(_t.g)(a)&&("panel"===t?n.a.createElement(Pt,{openInfoModal:h}):n.a.createElement(Kt,{openInfoModal:h}))),m&&n.a.createElement(bt,{mode:t,disabledGeneric:E,disabledAlreadyRedeemed:b,approvedPoints:d,claimClick:j,outOfStock:f,paidItemsRequired:p,rewardCost:a.cost})))};Nt.displayName="InCartRewardItem";var Ct=function(e){var t=e.mode,a=e.reward,r=Object(O.c)("reward-item",t);return n.a.createElement("div",{className:Object(O.a)("".concat(r,"__product-image"))},n.a.createElement("img",{src:a.options.productImageUrl,alt:"Photo of ".concat(a.displayTitle)}))},St=function(e){var t=e.mode,a=e.reward,r=Object(O.c)("reward-item",t);return n.a.createElement("div",{className:Object(O.a)("".concat(r,"__more-info-url"))},n.a.createElement("a",{"data-i18n-key":"ui.dashboard.redeem_points.view_product",href:a.options.productUrl},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_product"})))},Pt=function(e){var t=e.openInfoModal;return n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.terms_and_conditions",className:Object(O.a)("loyalty-panel-reward-item__more-info-url")},n.a.createElement("a",{href:"#",onClick:t},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.terms_and_conditions"})))},Kt=function(e){var t=e.openInfoModal;return n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.terms_and_conditions_title",onClick:t,className:Object(O.a)("reward-item__more-info-url")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.terms_and_conditions_title"}))},It=function(e){var t=e.reward,a=e.mode,c=Object(s.c)(function(e){var t=Object(l.j)(e);return{approvedPoints:t?Object(l.c)(e):0,customer:t}},[]),i=c.approvedPoints,o=c.customer,d=Object(s.d)(),u=Object(r.useCallback)(function(){d(Object(U.p)(t.id))},[d,t.id]),m=Object(r.useCallback)(function(){d(Object(U.r)(t.id))},[d,t.id]),b=Object(_t.g)(t),p=Object(_t.h)(t),f=Object(O.c)("reward-item",a);return n.a.createElement(pt,{mode:a,id:t.id,kind:t.kind},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__content"))},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__title"))},t.displayTitle),n.a.createElement("div",{className:Object(O.a)("".concat(f,"__meta"))},n.a.createElement("span",{"data-i18n-key":"ui.dashboard.redeem_points.product_percent_off",className:Object(O.a)("".concat(f,"__percent-off"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.product_percent_off",params:{discount:"".concat(t.options.discountAmount,"%")}})),n.a.createElement("span",{"data-i18n-key":"ui.general.points_count",className:Object(O.a)("".concat(f,"__cost"))},n.a.createElement(M.a,{i18nKey:"ui.general.points_count",params:{smart_count:t.cost}}))),n.a.createElement("div",{className:Object(O.a)("".concat(f,"__links"))},n.a.createElement("div",{className:Object(O.a)("".concat(f,"__more-info-url"))},p&&n.a.createElement("a",{"data-i18n-key":"ui.dashboard.redeem_points.view_product",href:t.options.productUrl},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_product"}))),b&&n.a.createElement("div",{className:Object(O.a)("".concat(f,"__terms-url"))},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.terms_and_conditions_title",onClick:m},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.terms_and_conditions_title"})))),o&&n.a.createElement(bt,{mode:a,outOfStock:!t.inStock,approvedPoints:i,claimClick:u,rewardCost:t.cost})))};It.displayName="ProductDiscountVoucherItem";var Rt=function(e){var t=e.rewardId,a=e.mode,r=Object(s.c)(function(e){return{reward:Object(ut.j)(e,t)}},[t]).reward;if(!r)return null;switch(r.kind){case"cartDiscountVoucher":return n.a.createElement(ft,{mode:a,reward:r});case"giftCard":return n.a.createElement(wt,{mode:a,reward:r});case"productCart":return n.a.createElement(Nt,{mode:a,reward:r});case"productDiscountVoucher":return n.a.createElement(It,{mode:a,reward:r});case"collectionDiscountVoucher":return n.a.createElement(jt,{mode:a,reward:r});case"freeShippingVoucher":return n.a.createElement(gt,{mode:a,reward:r});case"custom":return n.a.createElement(yt,{mode:a,reward:r});case"checkoutRedemption":return n.a.createElement(Ot,{mode:a,reward:r})}};Rt.displayName="RewardItem";var xt=function(e){var t=e.mode,a=Object(s.c)(function(e){return{rewardIds:Object(ut.l)(e,t)}},[t]).rewardIds,r="panel"===t?"loyalty-panel-page-rewards__rewards-list":"rewards-list";return n.a.createElement("div",{className:Object(O.a)(r)},a.map(function(e){return n.a.createElement(Rt,{key:e,mode:t,rewardId:e})}))};xt.displayName="RewardsList";var Tt=function(){var e=Object(s.c)(function(e){return{reward:Object(ut.f)(e),currency:Object(P.a)(e),localCurrency:Object(H.c)(e)}},[]),t=e.currency,a=e.localCurrency,r=e.reward;return r?n.a.createElement("div",{className:Object(O.b)("checkout-redemption-banner")},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.checkout_redemption_message",className:Object(O.b)("checkout-redemption-banner__icon icon__rule--product-purchase")}),n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.checkout_redemption_message",params:{points:r.options.pointsPerUnit,unit:Object(W.a)(t,a,1)}})):null};Tt.displayName="CheckoutRedemptionBanner";var Mt=function(){var e=Object(s.c)(function(e){return{primarySite:Object(i.h)(e)}},[]).primarySite;if(!e)throw new Error("Could not find primary site");var t=Object(O.c)("rewards","panel");return n.a.createElement("div",{className:Object(O.b)("".concat(t,"__go_to_primary_site"))},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.rewards_available_on_primary_site",className:Object(O.b)("".concat(t,"__go_to_primary_site__text"))},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_available_on_primary_site",params:{store_name:e.name}})),n.a.createElement("div",{className:Object(O.b)("".concat(t,"__go_to_primary_site__cta_outer"))},n.a.createElement("a",{"data-i18n-key":"ui.dashboard.redeem_points.go_to_other_site",className:Object(O.b)("action-button","".concat(t,"__go_to_primary_site__cta")),href:e.url},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.go_to_other_site",params:{store_name:e.name}}))))},Dt=function(){return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-ichive-rewards")},n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-ichive-rewards__section")},n.a.createElement("p",null,"Your earned points are valuable! Why? Because you can cash them in for free shit on The Chivery!")),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-ichive-rewards__section")},n.a.createElement("p",null,"Don't worry, redeeming your points will not reduce your total that we display (and judge you by) on iCHIVE, so go get some cool stuff and upload some pictures of you rocking it!")),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-ichive-rewards__section")},n.a.createElement("p",null,"Head on over to"," ",n.a.createElement("a",{href:"https://www.thechivery.com/account"},"The Chivery")," to see how many points you have to redeem and how much awesome stuff you can order!")),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-ichive-rewards__logo-section")},n.a.createElement("a",{href:"https://www.thechivery.com/account",className:Object(O.b)("loyalty-panel-page-ichive-rewards__logo-link")},n.a.createElement("img",{src:"//my.thechivery.com/img/thechivery/logo.png",alt:"The Chivery"}))))};Dt.displayName="IChiveRewardsPage";var At=function(){var e=Object(s.c)(function(e){return{site:Object(P.b)(e)}},[]).site;return 2141===e.id?n.a.createElement(Dt,null):"ecommerce"!==e.role?n.a.createElement(Lt,null,n.a.createElement(Mt,null)):n.a.createElement(Lt,null,n.a.createElement(dt,{mode:"panel"}),n.a.createElement(Tt,null),n.a.createElement(xt,{mode:"panel"}),n.a.createElement(Ft,null,n.a.createElement(st,{mode:"panel"})))};At.displayName="PanelRewardsPage";var Lt=function(e){var t=e.children,a=Object(O.c)("rewards","panel");return n.a.createElement("div",{className:Object(O.b)(a)},t)},Ft=function(e){var t=e.children;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-rewards__claimed-rewards")},n.a.createElement("div",{"data-i18n-key":"ui.dashboard.redeem_points.your_rewards",className:Object(O.b)("loyalty-panel-page-rewards__claimed-rewards-header")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.your_rewards"})),t)},Bt=a(186),Vt=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"openRewardsPanel",function(e){e.preventDefault(),a.setState(function(){return{isRewardsPanelOpen:!0}})}),Object(h.a)(Object(J.a)(a),"openRulesPanel",function(e){e.preventDefault(),a.setState(function(){return{isRulesPanelOpen:!0}})}),a.state={isRewardsPanelOpen:!1,isRulesPanelOpen:!1},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tier,a=e.spendMode,r=e.currency,c=e.localCurrency,i=this.state,o=i.isRewardsPanelOpen,l=i.isRulesPanelOpen;if(!t||!t.isCurrent&&t.hidden)return null;var s=4===t.rewardOverrides.length||4===t.ruleOverrides.length?4:3;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item",{"loyalty-panel-tier-item--current":t.isCurrent,"loyalty-panel-tier-item--previous":t.isPrevious,"loyalty-panel-tier-item--next":t.isNext})},n.a.createElement("header",{className:Object(O.b)("loyalty-panel-tier-item__header")},n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__name")},t.name),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__context")},t.isCurrent&&(t.expiresAt?n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.user_tier_info_expiry",params:{expires_at:t.expiresAt}}):n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.user_tier_info"})),t.isNext&&(t.conditions?n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.conditions_for_tier"}):"spend"===a?n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.spend_until_next_tier",params:{needed_spend:Object(W.a)(r,c,t.neededSpend)}}):n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.points_until_next_tier",params:{needed_points:t.neededPoints}})))),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__accent"),style:t.colour?{backgroundColor:t.colour}:{}}),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__inner",t.isPrevious&&"loyalty-panel-tier-item__inner--hide")},n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__list-container")},t.ruleOverrides.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__list-heading")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.earn_activities"})),n.a.createElement("ul",{className:Object(O.b)("loyalty-panel-tier-item__list")},t.ruleOverrides.filter(function(e){return e.enabled}).filter(function(e){return"signup"!==e.rule.kind}).filter(function(e,t){return l||t<s}).map(function(e){return n.a.createElement("li",{key:e.ruleId,className:Object(O.b)("loyalty-panel-tier-item__list-item","loyalty-panel-tier-item__list-item--rule")},"".concat(e.rule.displayTitle," - "),e.rule.isValuePerUnit?n.a.createElement(q,{className:Object(O.b)("loyalty-panel-tier-item__list-item-value"),isPerUnit:!0,points:e.value}):n.a.createElement("span",{className:Object(O.b)("loyalty-panel-tier-item__list-item-value")},Object(K.c)(e.value)))}),!l&&t.ruleOverrides.length>s&&n.a.createElement("li",{className:Object(O.b)("loyalty-panel-tier-item__list-item"),onClick:this.openRulesPanel},n.a.createElement("a",{href:"#",className:Object(O.b)("loyalty-panel-tier-item__view-more-link")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.view_more"})))))),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__list-container")},t.rewardOverrides.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.b)("loyalty-panel-tier-item__list-heading")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.redeem_points"})),n.a.createElement("ul",{className:Object(O.b)("loyalty-panel-tier-item__list")},t.rewardOverrides.filter(function(e){return e.enabled}).filter(function(e,t){return o||t<s}).map(function(e){return n.a.createElement("li",{key:e.rewardId,className:Object(O.b)("loyalty-panel-tier-item__list-item","loyalty-panel-tier-item__list-item--reward"),dangerouslySetInnerHTML:{__html:e.reward.displayTitle}})}),!o&&t.rewardOverrides.length>s&&n.a.createElement("li",{onClick:this.openRewardsPanel,className:Object(O.b)("loyalty-panel-tier-item__list-item")},n.a.createElement("a",{href:"#",className:Object(O.b)("loyalty-panel-tier-item__view-more-link")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.view_more"}))))))))}}]),t}(n.a.Component),Ut=Object(c.b)(function(e,t){var a=t.id;return{tier:Object(Bt.c)(e,a),spendMode:Object(i.j)(e).loyaltyTiersMode,currency:Object(P.a)(e),localCurrency:Object(H.c)(e)}})(Vt),Ht=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.loyaltyTierIds;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-tiers")},n.a.createElement("div",{id:Object(O.b)("loyalty-panel-content__overflow-container")},n.a.createElement("div",{className:Object(O.b)("loyalty-panel-page-tiers__tiers-list")},e.map(function(e){return n.a.createElement(Ut,{key:e,id:e})}))))}}]),t}(n.a.PureComponent),Wt=Object(c.b)(function(e){return{loyaltyTierIds:Object(Bt.d)(e)}})(Ht),qt=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.page,a=e.siteName;return e.isCustomerBlocked?n.a.createElement(D,null):n.a.createElement("div",{className:Object(O.b)("loyalty-panel-content","loyalty-panel-content--".concat(this.props.page.id))},n.a.createElement("header",{className:Object(O.b)("loyalty-panel-content__header")},Object(K.d)(t.i18nKeyTitle)),t.i18nKeyDescription&&n.a.createElement("div",{className:Object(O.b)("loyalty-panel-content__page-description"),dangerouslySetInnerHTML:{__html:Object(K.d)(t.i18nKeyDescription,{store_name:a})}}),n.a.createElement("div",{className:Object(O.b)("loyalty-panel-content__overflow-container")},this.getContentPage()))}},{key:"getContentPage",value:function(){switch(this.props.page.id){case"earn":return n.a.createElement(pe,null);case"rewards":return n.a.createElement(At,null);case"refer":return n.a.createElement(tt,null);case"tiers":return n.a.createElement(Wt,null);case"history":return n.a.createElement(we,null);case"help":return n.a.createElement(Oe,null)}}}]),t}(n.a.Component),Yt=Object(c.b)(function(e){return{page:T(e),siteName:Object(P.d)(e),isCustomerBlocked:Object(l.d)(e).blocked}})(qt),Gt=Object(c.b)(function(e){var t=Object(l.j)(e);return{isWhiteLabel:Object(i.j)(e).authorizedFeatures.whiteLabel,isLoggedIn:Boolean(t),isCustomerBlocked:!!t&&t.blocked}})(function(e){var t=e.isWhiteLabel,a=e.isLoggedIn,r=e.isCustomerBlocked;if(t||r)return null;var c=a?"loggedin":"loggedout",i=Object(O.b)({"loyalty-panel-sidebar__powered-by":a,"loyalty-splash__powered-by":!a});return n.a.createElement("div",{className:i},n.a.createElement("a",{className:"".concat(i,"-link"),href:"https://loyaltylion.com/shopify/free-plan?utm_campaign=poweredby&utm_source=ll&utm_medium=referral&utm_content=".concat(c),target:"_blank"},n.a.createElement(M.a,{i18nKey:"ui.general.powered_by"})," LoyaltyLion"))}),zt=a(439),Xt=a.n(zt),Jt=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"element",void 0),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.points,a=this.props.points;t!==a&&this.element&&new Xt.a(this.element,t,a,0,this.duration,{formattingFn:K.c}).start()}},{key:"render",value:function(){var e=this;return n.a.createElement("lionpoints",{ref:function(t){return e.element=t}},Object(K.c)(this.props.points))}},{key:"duration",get:function(){return 1}}]),t}(n.a.Component);function $t(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Zt=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleTiersClick",function(){return a.props.handleOnTiersClick("tiers")}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleCloseClick,a=e.isCustomerBlocked,n=e.isMobileMenuOpen,c=e.loyaltyTier,i=e.mode,o=e.onMobileMenuClick,l=e.programName,s=e.shouldDisplayLoyaltyTiers,d=e.totalPoints;return r.createElement("header",{className:Object(O.b)("loyalty-panel-sidebar__header")},"modal"===i&&r.createElement("a",{onClick:t,className:Object(O.b)("loyalty-panel-sidebar__mobile-close-button")},r.createElement(M.a,{i18nKey:"ui.dashboard.menu.return_to_store"})),r.createElement("div",{className:Object(O.b)("loyalty-panel-sidebar__title")},l),r.createElement("div",{className:Object(O.b)("loyalty-panel-sidebar__points")},r.createElement("span",{className:Object(O.b)("loyalty-panel-sidebar__points-value")},r.createElement(Jt,{points:d})),r.createElement("span",{className:Object(O.b)("loyalty-panel-sidebar__points-text")},r.createElement(M.a,{i18nKey:"sdk.points"}))),s&&!a&&c&&r.createElement("div",{className:Object(O.b)("loyalty-panel-sidebar__tier-info")},r.createElement("a",{className:Object(O.b)("loyalty-panel-sidebar__tier-info-link")},r.createElement("span",{className:Object(O.b)("loyalty-panel-sidebar__tier-info-icon")}),r.createElement("span",{onClick:this.handleTiersClick,className:Object(O.b)("loyalty-panel-sidebar__tier-info-name")},c.name))),r.createElement("a",{onClick:function(){return o(!n)},className:Object(O.b)("loyalty-panel-sidebar__mobile-menu-toggle-button",n&&"loyalty-panel-sidebar__mobile-menu-toggle-button--active")}))}}]),t}(r.PureComponent),Qt=Object(c.b)(function(e){return{shouldDisplayLoyaltyTiers:Object(Bt.a)(e),isCustomerBlocked:Object(l.d)(e).blocked,loyaltyTier:Object(l.f)(e),isMobileMenuOpen:Object(x.d)(e).isMobileMenuOpen,totalPoints:Object(l.h)(e).total,programName:Object(i.i)(e).name}},function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$t(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$t(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({handleCloseClick:S.a,onMobileMenuClick:U.H},e),{handleOnTiersClick:function(){return e(Object(U.a)("tiers"))}})})(Zt),ea=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(k.a)(this,Object(N.a)(t).call(this,e))).onClickHandler=a.onClickHandler.bind(Object(J.a)(a)),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isActive,a=e.page,r=Object(O.b)("loyalty-panel-sidebar__menu-item","loyalty-panel-sidebar__menu-item--icon","loyalty-panel-sidebar__menu-item--".concat(a.id),{active:t});return n.a.createElement("a",{className:r,onClick:this.onClickHandler},n.a.createElement(M.a,{i18nKey:a.i18nKeyMenu}))}},{key:"onClickHandler",value:function(){var e=this.props,t=e.page;(0,e.onChangePage)(t.id)}}]),t}(n.a.PureComponent),ta=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isMobileMenuOpen,a=e.isLoyaltyTiersEnabled,r=e.isReferralEnabled,c=e.currentPage,i=e.onChangePage;return e.isCustomerBlocked?null:n.a.createElement("nav",{className:Object(O.b)("loyalty-panel-sidebar__menu",t&&"loyalty-panel-sidebar__menu--open")},R.filter(function(e){return a||"tiers"!==e.id}).filter(function(e){return r||"refer"!==e.id}).map(function(e,t){return n.a.createElement(ea,{key:t,page:e,isActive:!!c&&e.id===c.id,onChangePage:function(e){return i(e)}})}))}}]),t}(n.a.PureComponent),aa=Object(c.b)(function(e){return{isLoyaltyTiersEnabled:Object(Bt.a)(e),isMobileMenuOpen:Object(x.d)(e).isMobileMenuOpen,isReferralEnabled:null!==Object(A.m)(e),currentPage:T(e),isCustomerBlocked:Object(l.d)(e).blocked}},{onChangePage:U.a})(ta),ra=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.mode,t=void 0===e?"modal":e;return n.a.createElement("div",{className:Object(O.b)("loyalty-panel-sidebar")},n.a.createElement(Qt,{mode:t}),n.a.createElement(aa,null),n.a.createElement(Gt,null))}}]),t}(n.a.PureComponent),na=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=Object(O.b)({"loyalty-panel":!0,"component--reset":!0,"loyalty-panel--format-modal":"modal"===this.props.mode,"loyalty-panel--format-embed":"embed"===this.props.mode}),t="modal"===this.props.mode?n.a.createElement("a",{onClick:this.props.closeModal,className:Object(O.b)("loyalty-panel__close-button")},""):null;return n.a.createElement("div",{className:e},t,n.a.createElement(ra,{mode:this.props.mode}),n.a.createElement(Yt,null))}}]),t}(n.a.Component);Object(h.a)(na,"displayName","LoyaltyPanel");var ca=Object(c.b)(null,{closeModal:S.a})(na),ia=a(27),oa=function(e){var t=e.introText,a=e.children,r=e.type;return n.a.createElement("div",{className:Object(O.b)("loyalty-splash-column","loyalty-splash-column--".concat(r))},n.a.createElement("div",{className:Object(O.b)("loyalty-splash-column__intro")},n.a.createElement("p",{className:Object(O.b)("loyalty-splash-column__intro-text")},t," ")),n.a.createElement("div",{className:Object(O.b)("loyalty-splash-column__items")},a))};function la(e){var t="icon__".concat("reward--"+Object(B.b)(e.kind));return Object(O.b)("loyalty-splash-item__icon","icon",t,Object(h.a)({},"".concat(t,"--subscription"),Object(ia.m)(e)))}var sa=Object(c.b)(function(e){return{rewards:Object(ut.n)(e),siteName:Object(P.b)(e).name}})(function(e){var t=e.siteName,a=e.rewards,r=n.a.createElement(M.a,{i18nKey:"ui.splash.rewards_heading_generalised",params:{store_name:t}});return n.a.createElement(oa,{introText:r,type:"rewards"},a.map(function(e,t){return n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item","loyalty-splash-item--reward"),key:t,"data-reward-id":"".concat(e.id)},n.a.createElement("div",{className:la(e)}),n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__info")},n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__title"),dangerouslySetInnerHTML:{__html:e.displayTitle}}),n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__value"),dangerouslySetInnerHTML:{__html:e.costText}})))}))});function da(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.map(function(e){return e.trim()}).filter(function(e){return!!e}).map(function(e){return/[\.\,\?\!\;\:]$/.test(e)?e:"".concat(e,".")}).join(" ")}var ua=Object(c.b)(function(e){return{rules:Object(A.t)(e)}})(function(e){var t=e.rules,a=n.a.createElement(M.a,{i18nKey:"ui.splash.earn_heading"});return n.a.createElement(oa,{introText:a,type:"rules"},t.map(function(e,t){return n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item","loyalty-splash-item--rule"),"data-rule-id":"".concat(e.id),key:t},n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__icon","icon","icon__".concat("rule--"+Object(B.b)(e.kind)))}),n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__info")},n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__title")},e.displayTitle),n.a.createElement("div",{className:Object(O.b)("loyalty-splash-item__value")},(a=e.valueText,/\<[a-z]/i.test(a)?n.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.valueText}}):e.valueText))));var a}))}),ma=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.programName,a=e.siteName,r=e.mode,c=e.loginURL,i=e.signupURL,o=Ge()(Object(O.b)("loyalty-splash"),Object(O.b)("component--reset"),Object(O.b)("loyalty-splash--format-".concat(r)));return n.a.createElement("div",{className:o},n.a.createElement("a",{onClick:this.props.onCloseClick,className:Object(O.b)("loyalty-splash__close-button")},""),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__mobile-bar")},n.a.createElement("a",{onClick:this.props.onCloseClick,className:Object(O.b)("loyalty-splash__mobile-close-button")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.menu.return_to_store"}))),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__heading")},n.a.createElement("div",{className:Object(O.b)("loyalty-splash__title")},n.a.createElement(M.a,{i18nKey:"ui.splash.introducing_programme",params:{name:t}})),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__title","loyalty-splash__title--welcome")},n.a.createElement(M.a,{i18nKey:"ui.splash.welcome_to_loyalty_program",params:{name:t}}))),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__content")},n.a.createElement(sa,null),n.a.createElement(ua,null)),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__footer")},n.a.createElement("p",{className:Object(O.b)("loyalty-splash__get-started-text")},n.a.createElement(M.a,{i18nKey:"ui.splash.login_start_personalised",params:{store_name:a}})),n.a.createElement("div",{className:Object(O.b)("loyalty-splash__actions")},n.a.createElement("a",{href:c,className:Object(O.b)("action-button")},n.a.createElement(M.a,{i18nKey:"ui.splash.login"})),n.a.createElement("span",{className:Object(O.b)("loyalty-splash__button-spacer")},"/"),n.a.createElement("a",{href:i,className:Object(O.b)("action-button")},n.a.createElement(M.a,{i18nKey:"ui.splash.signup"}))),n.a.createElement(Gt,null)))}}]),t}(n.a.Component);Object(h.a)(ma,"displayName","LoyaltySplash");var ba=Object(c.b)(function(e){var t=Object(F.a)(e).urls,a=t.login,r=t.signup;return{programName:Object(i.i)(e).name,siteName:Object(P.b)(e).name,loginURL:a,signupURL:r}},{onCloseClick:S.a})(ma),pa=a(111),fa=a(69),Oa=a(40),_a=a(80),ja=a(39),ha=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"name","NoModalError"),a}return Object(C.a)(t,e),t}(Object(ja.a)(Error)),ya=function(e){if(!e.modals)throw new ha("Modal Selector requires a modal");return e.modals},va=Object(I.createSelector)(ya,function(e){return e.postPurchaseGuestSignUp.isOpen}),Ea=(Object(I.createSelector)(ya,function(e){return e.postPurchaseGuestSignUp.forCampaignId}),a(437)),ga=a(196),wa=function(e){var t=e.isOpen,a=e.title,r=e.onCloseClick,c=e.onBackgroundClick,i=e.options,o=void 0===i?{}:i,l=e.className,s=e.children,d=e.size,u=void 0===d?"large":d,m=t?n.a.createElement(Ea.CSSTransition,{key:"1",in:t,classNames:{enter:Object(O.b)("modal-and-screen--enter"),enterActive:Object(O.b)("modal-and-screen--enter-active"),exit:Object(O.b)("modal-and-screen--exit"),exitActive:Object(O.b)("modal-and-screen--exit-active")},timeout:150},n.a.createElement("div",{className:Object(O.b)("modal-and-screen")},n.a.createElement("div",{className:Object(O.b)("screen","screen--light"),onClick:c}),n.a.createElement("div",{className:Object(O.b)("modal","modal--".concat(u))+" "+(l||"")},a&&n.a.createElement("div",{className:Object(O.b)("modal__header")},n.a.createElement("div",{className:Object(O.b)("modal__title")},a),n.a.createElement("a",{className:Object(O.b)("modal__close-button"),onClick:r},"")),n.a.createElement("div",{className:Object(O.b)("modal__content",o.noPadding?"modal__content--no-padding":"")},n.a.createElement(ga.a,null,!a&&n.a.createElement("a",{className:Object(O.b)("modal__close-button"),onClick:r},""),s))))):null;return n.a.createElement(Ea.TransitionGroup,null,m)},ka=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.loginURL,a=e.signupURL,r=e.campaign,c=e.closeModal,i=e.closeModalTracked,o=e.isModalOpen;return n.a.createElement(wa,{isOpen:o,onCloseClick:c},n.a.createElement("div",{className:Object(O.b)("guest-sign-up-modal__header")},n.a.createElement("h1",null,n.a.createElement(M.a,{i18nKey:"ui.guest_sign_up_notification.heading"}))),n.a.createElement("div",{className:Object(O.b)("guest-sign-up-modal__incentive")},n.a.createElement("div",{className:Object(O.b)("guest-sign-up-modal__incentive--message")},r?r.options.siteNotificationText:n.a.createElement(M.a,{i18nKey:"ui.guest_sign_up_notification.points_missed_text"}))),n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("guest-sign-up-modal__continue"),onClick:i},n.a.createElement("a",{className:Object(O.b)("action-button","guest-sign-up-modal__continue--button"),href:a},n.a.createElement(M.a,{i18nKey:"ui.guest_sign_up_notification.sign_up"})),n.a.createElement("a",{className:Object(O.b)("guest-sign-up-modal__login--button"),href:t},n.a.createElement(M.a,{i18nKey:"ui.guest_sign_up_notification.log_in"}))))," ")}}]),t}(n.a.PureComponent),Na=Object(c.b)(function(e){var t=Object(F.a)(e).urls,a=t.login,r=t.signup;return{isModalOpen:va(e),campaign:Object(fa.d)(e),loginURL:a,signupURL:r}},function(e){return{closeModal:function(){e(Object(_a.a)())},closeModalTracked:function(){e(Object(_a.a)()),e(Object(pa.b)(Oa.a.ClickedGuestPostPurchaseSignUpNotification))}}})(ka),Ca=Object(c.b)(function(e){return{locale:Object(L.b)(e)}})(function(e){var t=e.action,a=e.locale;return n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__basic")},n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__info")},"rule"===t.type||"reward"===t.type?n.a.createElement("div",{className:Object(O.b)("history-state-bubble","history-state-bubble--".concat(t.state),"history-info-modal-content__state-bubble")},n.a.createElement(je,{pointState:t.state})):null,n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__points")},n.a.createElement(M.a,{i18nKey:"ui.general.points_count_raw",params:{smart_count:t.points}})),n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__date")},Object(rt.a)(new Date(t.date),new Date,{addSuffix:!0,locale:Object(ct.a)(a)}))))});var Sa=Object(c.b)(function(e){return{rechargeHash:Object(l.e)(e).rechargeHash||null,domain:Object(P.b)(e).domain}})(function(e){var t=e.rechargeHash,a=e.domain;return t?n.a.createElement("div",{className:Object(O.b)("manage-subscriptions-link")},n.a.createElement("a",{href:"https://".concat(a,"/tools/recurring/login")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.apply_subscription_discount"}))):null}),Pa=function(e){var t=e.code;return n.a.createElement("div",{className:Object(O.b)("reward-code")},n.a.createElement("div",{className:Object(O.b)("reward-code__code")},t),n.a.createElement(Je,{clipboardText:t,className:Object(O.b)("reward-code__clipboard-button")}))},Ka=Object(c.b)(function(e,t){return{claimedReward:Object(at.c)(e,t.claimedRewardId),currency:Object(P.a)(e),localCurrency:Object(H.c)(e),locale:Object(L.b)(e)}})(function(e){var t=e.claimedReward,a=e.currency,r=e.localCurrency,c=e.locale;if(!t)throw new nt.a("HistoryInfoModalRewardContent needs a ClaimedReward");var i="voucher"in t?t.voucher:"giftCard"in t?t.giftCard:null;if(i){var o=t.usedAt,l="giftCard"===t.kind&&t.giftCard.balance;if(o){var s=Object(rt.a)(new Date(o),new Date,{addSuffix:!0,locale:Object(ct.a)(c)});return n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.reward_used_ago",params:{time_ago:s}})}if(l){var d=i;return n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__comment-balance")},n.a.createElement("b",null,n.a.createElement(M.a,{i18nKey:"ui.general.rewards.gift_card_balance_label"}),":"),n.a.createElement("span",{className:Object(O.b)("history-info-modal-content__comment-balance-amount")},n.a.createElement("span",{dangerouslySetInnerHTML:{__html:" ".concat(Object(W.a)(a,r,d.balance/100)," / ").concat(Object(W.a)(a,r,d.initialValue/100))}}))),n.a.createElement(Pa,{code:i.code}))}return"cartDiscountVoucher"===t.kind&&t.reward.options.discountMinimumSpend&&t.reward.options.discountMinimumSpend>0?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__comment-min-spend")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_meta_min_spend",params:{amount:Object(W.a)(a,r,t.reward.options.discountMinimumSpend)}})),n.a.createElement(Pa,{code:i.code})):n.a.createElement(n.a.Fragment,null,n.a.createElement(Pa,{code:i.code}),Object(ia.m)(t.reward)&&n.a.createElement(Sa,null))}if("custom"===t.kind){var u=t.fulfilment.fulfilledAt;return n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__comment--left")},n.a.createElement("b",null,n.a.createElement(M.a,{i18nKey:"ui.general.status"}),":")," ",u?n.a.createElement(M.a,{i18nKey:"ui.general.fulfilled_on",params:{date:u}}):n.a.createElement(M.a,{i18nKey:"ui.general.pending"}))}return null}),Ia=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.action;return n.a.createElement(wa,{isOpen:!!e,onCloseClick:e?this.props.closeHistoryInfoModal:null,onBackgroundClick:e?this.props.closeHistoryInfoModal:null,title:e?n.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.actionText}}):null,options:{noPadding:!0},className:Object(O.b)("modal--history-info")},e?this.getInfoModalContent(e):null)}},{key:"getInfoModalContent",value:function(e){var t=this.props.customer?function(e,t,a){switch(e.type){case"reward":if("void"===e.state)return n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.reward_refunded"});if("approved"===e.state)return n.a.createElement(Ka,{claimedRewardId:e.claimedRewardId});break;case"rule":if("expired"===e.state)return n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.points_expired"});var r=t.find(function(t){return t.id===e.ruleId});if(!r)return null;if("purchase"===r.kind||"referral"===r.kind)switch(e.state){case"declined":return n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.purchase_declined"});case"void":return n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.purchase_void"});case"pending":return e.approveDate?n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.purchase_pending",params:{time:Object(rt.a)(e.approveDate,new Date,{locale:Object(ct.a)(a)})}}):n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.purchase_pending_unpaid"})}else if("pending"===e.state&&e.approveDate)return n.a.createElement(M.a,{i18nKey:"ui.dashboard.account.comments.pending",params:{time:Object(rt.a)(e.approveDate,new Date,{locale:Object(ct.a)(a)})}})}return null}(e,this.props.programRules,this.props.currentLocale):null;return n.a.createElement("div",{className:Object(O.b)("history-info-modal-content")},n.a.createElement(Ca,{action:e}),t?n.a.createElement("div",{className:Object(O.b)("history-info-modal-content__comment")},t):null)}},{key:"action",get:function(){if(this.props.customer&&this.props.openFor){var e=this.props.openFor;switch(e.type){case"action":return this.props.actions.find(function(t){return t.id===e.id})||null;case"claimedReward":var t=this.props.claimedRewards.find(function(t){return t.id===e.id});return t?function(e){return{actionText:e.displayTitle,claimedRewardId:e.id,date:e.createdAt,id:String(e.id),points:e.cost,rewardId:e.rewardId,state:e.state,type:"reward",displayPoints:"-".concat(e.cost.toString())}}(t):null}}return null}}]),t}(n.a.Component);Object(h.a)(Ia,"displayName","HistoryInfoModal");var Ra=Object(c.b)(function(e){return{actions:Object(_e.b)(e),claimedRewards:Object(at.e)(e),currentLocale:Object(L.b)(e),customer:Object(l.j)(e),openFor:Object(x.b)(e),programRewards:Object(ut.m)(e),programRules:Object(A.s)(e)}},{closeHistoryInfoModal:U.b})(Ia),xa=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"historyLinkDiv",void 0),Object(h.a)(Object(J.a)(a),"handleAccountClick",function(e){e.preventDefault(),a.props.close(),a.props.changePage("history")}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:Object(O.b)("pending-points-help-modal-content")},n.a.createElement("div",{className:Object(O.b)("pending-points-help-modal-content__heading")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.points_help.heading_why"})),n.a.createElement("div",{ref:function(t){return e.historyLinkDiv=t},className:Object(O.b)("pending-points-help-modal-content__text")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.points_help.content"})))}},{key:"componentDidMount",value:function(){if(this.historyLinkDiv){var e=Object(ie.a)(this.historyLinkDiv.getElementsByTagName("a")).find(function(e){return"account"===e.getAttribute("data-link")});e&&e.addEventListener("click",this.handleAccountClick)}}},{key:"componentWillUnmount",value:function(){this.historyLinkDiv&&this.historyLinkDiv.removeEventListener("click",this.handleAccountClick)}}]),t}(n.a.PureComponent),Ta=Object(c.b)(null,{changePage:U.a,close:U.c})(xa),Ma=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(wa,{isOpen:this.props.isOpen,onCloseClick:function(){return e.props.close()},onBackgroundClick:function(){return e.props.close()},title:"Help",className:Object(O.b)("modal--pending-points-help")},n.a.createElement(Ta,null))}}]),t}(n.a.Component);Object(h.a)(Ma,"displayName","PendingPointsHelpModal");var Da=Object(c.b)(function(e){return{isOpen:Object(x.c)(e)}},{close:U.c})(Ma),Aa=a(103);function La(e){return e.referred}var Fa=Object(I.createSelector)(La,function(e){return e.isModalOpen}),Ba=Object(I.createSelector)(La,function(e){return e.isDiscountAppliedModalOpen}),Va=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.close,a=e.isModalOpen;return n.a.createElement(wa,{isOpen:a,onCloseClick:t,onBackgroundClick:t},n.a.createElement("div",{className:Object(O.b)("referral-discount-applied-modal--header")},n.a.createElement("h1",null,n.a.createElement(M.a,{i18nKey:"ui.referree_notification.discount_applied_header"}))),n.a.createElement("div",{className:Object(O.b)("referral-discount-applied-modal--content")},n.a.createElement("div",{className:Object(O.b)("referral-discount-applied-modal--content--message")},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.discount_applied_content"}))),n.a.createElement("div",{className:Object(O.b)("referral-discount-applied-modal--continue"),onClick:t},n.a.createElement("a",{className:Object(O.b)("action-button","referral-discount-applied-modal--continue--button"),href:"#"},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.continue"}))))}}]),t}(n.a.PureComponent),Ua=Object(c.b)(function(e){return{isModalOpen:Ba(e)}},function(e){return{close:function(){e(Object(Aa.d)(!1))}}})(Va),Ha=a(455),Wa=a(148),qa=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.createElement("div",{className:Object(O.b)("referral-modal--incentive--code")},this.getContent())}},{key:"getContent",value:function(){var e=this.props.refereeIncentiveCodeState,t=e.isFetching,a=e.error,n=e.value;return t?r.createElement("div",{className:Object(O.b)("standalone-spinner")}):a||!n?r.createElement("div",{className:Object(O.b)("referral-modal--incentive--code__error")},r.createElement(M.a,{i18nKey:"ui.general.error"})):r.createElement(Pa,{code:n})}}]),t}(r.PureComponent);Object(h.a)(qa,"displayName","RefereeIncentiveCode");var Ya=Object(c.b)(function(e){return{refereeIncentiveCodeState:Object(Ha.a)(e)}})(qa),Ga=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.refereeIncentiveSettings,a=e.close,r=e.isModalOpen;return n.a.createElement(wa,{isOpen:r,onCloseClick:a,onBackgroundClick:a},n.a.createElement("div",{className:Object(O.b)("referral-modal--header")},n.a.createElement("h1",null,n.a.createElement(M.a,{i18nKey:"ui.referree_notification.heading"}))),n.a.createElement("div",{className:Object(O.b)("referral-modal--incentive")},n.a.createElement("div",{className:Object(O.b)("referral-modal--incentive--message")},this.renderIncentiveMessage(t)),n.a.createElement(Ya,null)),this.renderContentByPlatformType())}},{key:"renderIncentiveMessage",value:function(e){var t=this.props,a=t.currency,r=t.localCurrency;if(!e)return null;switch(e.kind){case"free_shipping":return n.a.createElement(M.a,{i18nKey:"ui.referree_notification.free_shipping_voucher_text"});case"cart_discount":var c=e.minimumSpend,i=Object(Ke.a)({incentive:e,currency:a,localCurrency:r});return c>0?n.a.createElement(M.a,{i18nKey:"ui.referree_notification.voucher_discount_text_min_spend",params:{amount:Object(W.a)(a,r,c),discount:i}}):n.a.createElement(M.a,{i18nKey:"ui.referree_notification.voucher_discount_text",params:{discount:i}})}}},{key:"renderContentByPlatformType",value:function(){var e=this.props,t=e.isShopifyStore,a=e.refereeIncentiveCodeState,r=e.close,c=e.activeRechargeIntegration;return t&&!c?n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("referral-modal--more")}),n.a.createElement("div",{className:Object(O.b)("referral-modal--continue"),onClick:r},n.a.createElement("a",{className:Object(O.b)("action-button","referral-modal--continue--button"),href:"/discount/".concat(a.value,"?redirect=").concat(window.location.pathname,"?discount_applied=").concat(a.value)},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.apply_discount"})))):n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("referral-modal--more")},n.a.createElement("div",null,n.a.createElement("h3",{className:Object(O.b)("referral-modal--more--title")},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.voucher_help_heading"})),n.a.createElement("p",{className:Object(O.b)("referral-modal--more--text")},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.voucher_help_content"})))),n.a.createElement("div",{className:Object(O.b)("referral-modal--continue"),onClick:r},n.a.createElement("a",{className:Object(O.b)("action-button","referral-modal--continue--button"),href:window.location.pathname},n.a.createElement(M.a,{i18nKey:"ui.referree_notification.continue"}))))}}]),t}(n.a.PureComponent),za=Object(c.b)(function(e){return{refereeIncentiveSettings:Object(Se.a)(e),isModalOpen:Fa(e),currency:Object(P.a)(e),localCurrency:Object(H.c)(e),numberLocale:Object(L.c)(e),refereeIncentiveCodeState:Object(Ha.a)(e),isShopifyStore:"shopify"===Object(P.e)(e),activeRechargeIntegration:Boolean(Object(Wa.a)(e))}},{close:Aa.a})(Ga),Xa=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props.isOpen?n.a.createElement(Ea.CSSTransition,{key:"1",in:this.props.isOpen,classNames:{enter:Object(O.b)("modal-and-screen--enter"),enterActive:Object(O.b)("modal-and-screen--enter-active"),exit:Object(O.b)("modal-and-screen--exit"),exitActive:Object(O.b)("modal-and-screen--exit-active")},timeout:150},n.a.createElement("div",{className:Object(O.b)("modal-and-screen")},n.a.createElement("div",{className:Object(O.b)("screen","screen--light"),onClick:function(){return e.props.closeModal()}}),n.a.createElement("div",{className:Object(O.b)("referral-widget-modal",this.props.onThankYou&&"referral-widget-modal--checkout")},n.a.createElement("div",{className:Object(O.b)("referral-widget-modal__header")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.header"})),n.a.createElement("a",{className:Object(O.b)("referral-widget-modal__close-button"),onClick:function(){return e.props.closeModal()}},""),n.a.createElement(ga.a,null,this.props.customer?n.a.createElement(Qe,{format:"modal"}):n.a.createElement(et,null))))):null;return n.a.createElement(Ea.TransitionGroup,null,t)}}]),t}(n.a.PureComponent);Object(h.a)(Xa,"displayName","ReferralWidgetModal");var Ja,$a=Object(c.b)(function(e){return{customer:Object(l.j)(e),isOpen:e.loyaltyPanel.isReferralWidgetModalOpen,onThankYou:Object(H.d)(e)}},{closeModal:U.e})(Xa);!function(e){e[e.Confirm=0]="Confirm",e[e.Cancel=1]="Cancel"}(Ja||(Ja={}));var Za=function(e){var t=e.handleClick,a=e.disabled,r=e.submitting,c=e.labelI18nKey,i=e.buttonKind;return n.a.createElement("div",{onClick:a?function(){return null}:function(){return t()},className:Object(O.b)("action-button","action-button--fixed-width","redeem-reward-modal__button",i===Ja.Cancel?"redeem-reward-modal__button--cancel":"",i===Ja.Cancel?"action-button--neutral":"",i===Ja.Confirm?"redeem-reward-modal__button--confirm":"",r?"action-button--loading":"",a?"action-button--disabled":"")},n.a.createElement(M.a,{i18nKey:c}))},Qa=function(e){var t=e.i18nKey,a=void 0===t?"ui.general.error":t;return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__error")},n.a.createElement(M.a,{i18nKey:a})))};function er(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var tr=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?er(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):er(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.otherRedeeming,o=e.redeeming,l=e.reward,s=e.success;if(r)return n.a.createElement(Qa,null);if(s&&s.id===l.id){if(!t||"cartDiscountVoucher"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_page_info"})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__code-container")},n.a.createElement(Pa,{code:t.voucher.code})),Object(ia.m)(t.reward)&&n.a.createElement(Sa,null))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},l.redeemConfirm),l.minimumSpend&&n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__minimum-spend"),dangerouslySetInnerHTML:{__html:l.minimumSpend}}),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))});function ar(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var rr=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e),showRewardSummaryExtra:"shopify"===Object(P.e)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ar(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ar(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.otherRedeeming,o=e.redeeming,l=e.reward,s=e.success,d=e.showRewardSummaryExtra;if(r)return n.a.createElement(Qa,null);if(s&&s.id===l.id){if(!t||"collectionDiscountVoucher"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_page_info"})),d,n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__code-container")},n.a.createElement(Pa,{code:t.voucher.code})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement("a",{href:l.options.collectionUrl,className:Object(O.b)("action-button","action-button--fixed-width","redeem-reward-modal__button","redeem-reward-modal__button--margin-right")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_collection"})),n.a.createElement("a",{href:"/cart",className:Object(O.b)("action-button","action-button--fixed-width","redeem-reward-modal__button","redeem-reward-modal__button--margin-left")},n.a.createElement(M.a,{i18nKey:"ui.general.go_to_cart"}))))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},l.redeemConfirm),l.minimumSpend&&n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__minimum-spend"),dangerouslySetInnerHTML:{__html:l.minimumSpend}}),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))}),nr=a(150);function cr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var ir=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),locale:Object(L.b)(e),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cr(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cr(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.locale,o=e.otherRedeeming,l=e.redeeming,s=e.reward,d=e.success;if(r)return n.a.createElement(Qa,null);if(d&&d.id===s.id){if(!t||"custom"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},Object(nr.a)(t.reward.fulfilmentInstructions,i)))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},s.redeemConfirm),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:o,labelI18nKey:"ui.general.yes",submitting:l,buttonKind:Ja.Confirm}))))});function or(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var lr=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?or(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):or(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.otherRedeeming,o=e.redeeming,l=e.reward,s=e.success;if(r)return n.a.createElement(Qa,null);if(s&&s.id===l.id){if(!t||"freeShippingVoucher"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_page_info"})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__code-container")},n.a.createElement(Pa,{code:t.voucher.code})))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},l.redeemConfirm),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))});function sr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var dr=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?sr(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sr(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.otherRedeeming,o=e.redeeming,l=e.reward,s=e.success;if(r)return n.a.createElement(Qa,null);if(s&&s.id===l.id){if(!t||"giftCard"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.gift_card_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_page_info"})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__code-container")},n.a.createElement(Pa,{code:t.giftCard.code})))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},l.redeemConfirm),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))}),ur=a(133),mr=function(e){var t=e.reward,a=Object(s.c)(function(e){var a=Object(x.i)(e);return{redeemError:Object(x.e)(e,t.id),otherRedeeming:null!==a&&a!==t.id,redeeming:a===t.id,success:Object(x.h)(e)}},[t.id]),c=a.redeemError,i=a.otherRedeeming,o=a.redeeming,l=a.success,d=Object(r.useState)(t.options.productVariants[0].id),u=Object(ur.a)(d,2),m=u[0],b=u[1],p=Object(s.d)(),f=Object(r.useCallback)(function(){p(Object(U.d)())},[p]),_=Object(r.useCallback)(Object(X.a)(z.a.mark(function e(){var a;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=m?parseInt(m,10):void 0,e.abrupt("return",p(Object(U.t)({id:t.id,variantId:a})));case 2:case"end":return e.stop()}},e)})),[p,t.id,m]),j=Object(r.useCallback)(function(e){e.persist(),b(e.target.value)},[]);if(c&&Object(_t.e)(c.name))return n.a.createElement(Qa,{i18nKey:"ui.dashboard.redeem_points.too_many_requests"});if(c&&!Object(_t.d)(c.name))return n.a.createElement(Qa,null);if(l&&l.id===t.id)return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content-item")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__success-message")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.bwp_product_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.bwp_product_instructions"})));var h=t.options.productVariants,y=(null==c?void 0:c.affectedVariants)?c.affectedVariants:[],v=Object(ie.c)(y,m);return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},t.redeemConfirm),t.minimumSpend&&n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__minimum-spend"),dangerouslySetInnerHTML:{__html:t.minimumSpend}}),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary-extra")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.free_product_extra_confirm_text"})),h.length>1&&n.a.createElement(pr,{handleSelect:j,selectedVariantId:m,outOfStockVariantIds:y,variants:h}),v?n.a.createElement(Za,{handleClick:br,disabled:!0,labelI18nKey:"ui.dashboard.redeem_points.out_of_stock",submitting:!1,buttonKind:Ja.Cancel}):n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:f,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:_,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))};function br(){}var pr=function(e){var t=e.handleSelect,a=e.outOfStockVariantIds,r=e.selectedVariantId,c=e.variants;return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__free-product-variant-selector")},n.a.createElement("select",{value:r,onChange:t},c.map(function(e){return n.a.createElement("option",{key:e.position,value:e.id},e.title,Object(ie.c)(a,e.id)?" - ".concat(Object(K.d)("ui.dashboard.redeem_points.out_of_stock")):"")})))};function fr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Or=Object(c.b)(function(e,t){var a=Object(x.i)(e);return{claimedReward:Object(at.g)(e),error:Object(x.e)(e,t.reward.id),otherRedeeming:null!==a&&a!==t.reward.id,redeeming:a===t.reward.id,success:Object(x.h)(e),showRewardSummaryExtra:"shopify"===Object(P.e)(e)}},function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fr(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fr(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({closeModal:U.d},e),{handleRedeemReward:function(){return e(Object(U.v)({id:t.reward.id}))}})})(function(e){var t=e.claimedReward,a=e.closeModal,r=e.error,c=e.handleRedeemReward,i=e.otherRedeeming,o=e.redeeming,l=e.reward,s=e.success,d=e.showRewardSummaryExtra;if(r)return n.a.createElement(Qa,null);if(s&&s.id===l.id){if(!t||"productDiscountVoucher"!==t.kind)throw new nt.a("Rendering claimed reward success requires a Claimed Reward");return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.voucher_success_message"})," ",n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.rewards_page_info"})),d&&n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__summary-extra")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.product_shopify_redeem_instructions"})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__code-container")},n.a.createElement(Pa,{code:t.voucher.code})),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement("a",{href:l.options.productUrl,className:Object(O.b)("action-button","action-button--fixed-width","redeem-reward-modal__button","redeem-reward-modal__button--margin-right")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.view_product"})),n.a.createElement("a",{href:"/cart",className:Object(O.b)("action-button","action-button--fixed-width","redeem-reward-modal__button","redeem-reward-modal__button--margin-left")},n.a.createElement(M.a,{i18nKey:"ui.general.go_to_cart"}))))}return n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__content")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-box")},n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__confirm-summary")},l.redeemConfirm),l.minimumSpend&&n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__minimum-spend"),dangerouslySetInnerHTML:{__html:l.minimumSpend}}),n.a.createElement("div",{className:Object(O.b)("redeem-reward-modal__button-container")},n.a.createElement(Za,{handleClick:a,disabled:!1,labelI18nKey:"ui.general.not_now",submitting:!1,buttonKind:Ja.Cancel}),n.a.createElement(Za,{handleClick:c,disabled:i,labelI18nKey:"ui.general.yes",submitting:o,buttonKind:Ja.Confirm}))))}),_r=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props,t=e.closeModal,a=e.reward;return n.a.createElement(wa,{className:Object(O.b)("redeem-reward-modal"),size:"small",isOpen:null!==a,title:a&&n.a.createElement("span",{dangerouslySetInnerHTML:{__html:a.displayTitle}}),onCloseClick:t,onBackgroundClick:t},this.getRewardModal())}},{key:"getRewardModal",value:function(){var e=this.props.reward;if(!e)return null;switch(e.kind){case"cartDiscountVoucher":return n.a.createElement(tr,{reward:e});case"giftCard":return n.a.createElement(dr,{reward:e});case"productCart":return n.a.createElement(mr,{reward:e});case"productDiscountVoucher":return n.a.createElement(Or,{reward:e});case"collectionDiscountVoucher":return n.a.createElement(rr,{reward:e});case"freeShippingVoucher":return n.a.createElement(lr,{reward:e});case"custom":return n.a.createElement(ir,{reward:e});default:return V.a.error("Unable to render modal for reward kind: ".concat(e.kind),{reward:e}),null}}}]),t}(n.a.PureComponent);Object(h.a)(_r,"displayName","RedeemRewardModal");var jr=Object(c.b)(function(e){return{reward:Object(ut.i)(e)}},{closeModal:U.d})(_r),hr=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.reward;return n.a.createElement(wa,{isOpen:null!==e,onCloseClick:this.props.close,onBackgroundClick:this.props.close,className:Object(O.b)("redeem-reward-modal")},n.a.createElement("div",{className:Object(O.b)("reward-description-modal-content")},null==e?void 0:e.description))}}]),t}(n.a.PureComponent);Object(h.a)(hr,"displayName","RewardDescriptionModal");var yr=Object(c.b)(function(e){return{reward:Object(ut.k)(e)}},{close:U.f})(hr),vr=a(158),Er=function(){var e=Object(r.useState)(""),t=Object(ur.a)(e,2),a=t[0],c=t[1],i=Object(r.useState)(!1),o=Object(ur.a)(i,2),l=o[0],d=o[1],u=Object(s.e)(Object(r.useCallback)(function(e){return e.instagram},[])),m=u.savingUsernameError,b=u.savingUsernameRequesting,p=Object(s.d)();return n.a.createElement("div",{className:Object(O.a)("instagram-request-username")},n.a.createElement("form",{"data-testid":"username-form",onSubmit:function(e){e.preventDefault(),d(!0),gr(a)&&p(Object(vr.b)(a))}},n.a.createElement("div",{className:Object(O.a)("instagram-request-username__help")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.instagram.request_username"})),n.a.createElement("div",{className:Object(O.a)("instagram-request-username__entry")},n.a.createElement("input",{"data-testid":"username-input",type:"text",className:Object(O.a)("instagram-request-username__input",l&&!gr(a)?"instagram-request-username__input--error":""),value:a,disabled:b,onChange:function(e){d(!0),c(e.target.value)}}),n.a.createElement("button",{type:"submit",className:Object(O.a)("action-button","action-modal__button","instagram-request-username__submit-button",b?"action-button--loading":"")},n.a.createElement(M.a,{i18nKey:"ui.general.button_action_save"}))),m&&n.a.createElement("div",{className:Object(O.a)("instagram-request-username__error")},m)))};function gr(e){return e.length>0&&e.length<=100}var wr=a(435),kr=a(249),Nr=a(130),Cr=a(442),Sr=a(443),Pr=a(434),Kr=a(444);function Ir(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function Rr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ir(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ir(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var xr=function(e,t){return e.replace(/[^0-9]/g,"").slice(0,t)},Tr=function(e){if(""===e)return null;var t=parseInt(e,10);return isNaN(t)?null:t},Mr=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(k.a)(this,Object(N.a)(t).call(this,e))).state={day:"",month:"",touched:{day:!1,month:!1,submit:!1,year:!1},year:""},a.handleSubmit=a.handleSubmit.bind(Object(J.a)(a)),a.handleMonthChange=a.handleMonthChange.bind(Object(J.a)(a)),a.handleDayChange=a.handleDayChange.bind(Object(J.a)(a)),a.handleYearChange=a.handleYearChange.bind(Object(J.a)(a)),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"handleMonthChange",value:function(e){e.persist(),this.setState({month:e.target.value,touched:Rr({},this.state.touched,{month:!0,submit:!1})})}},{key:"handleDayChange",value:function(e){e.persist(),this.setState({day:xr(e.target.value,2),touched:Rr({},this.state.touched,{day:!0,submit:!1})})}},{key:"handleYearChange",value:function(e){e.persist(),this.setState({touched:Rr({},this.state.touched,{year:!0,submit:!1}),year:xr(e.target.value,4)})}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),e.persist(),!this.props.isSubmitting&&(this.setState({touched:{day:!0,month:!0,submit:!0,year:!0}}),this.isValid())){var t=new Date(this.year,this.month,this.day);this.props.submit(Object(wr.a)(t,"yyyy-MM-dd"))}}},{key:"componentWillUnmount",value:function(){this.props.reset()}},{key:"isValid",value:function(){return this.isMonthValid()&&this.isYearValid()&&this.isDayValid()}},{key:"isMonthValid",value:function(){return null!==this.month&&this.month>=0&&this.month<12}},{key:"isDayValid",value:function(){var e=null!==this.month&&this.isMonthValid()&&null!==this.year&&this.isYearValid()?Object(kr.a)(new Date(this.year,this.month)):31;return null!==this.day&&this.day>0&&this.day<=e}},{key:"isYearValid",value:function(){var e=(new Date).getFullYear();return null!==this.year&&this.year>e-120&&this.year<e}},{key:"render",value:function(){if(this.props.customer&&this.props.customer.birthday&&!this.props.isSubmitSuccess){var e=Object(Nr.a)(new Date),t=Object(Cr.a)(new Date(this.props.customer.birthday),e.getFullYear()),a=Object(Sr.a)(t,e)?Object(Pr.a)(t,1):t,r=Object(Kr.a)(a,e,{locale:Object(ct.a)(this.props.locale)}),c=0===r?"Happy birthday!":n.a.createElement(M.a,{i18nKey:"defaults.rules.birthday.description",params:{days_count:r,smart_count:this.props.rule.value}});return n.a.createElement("div",{className:Object(O.b)("birthday-action")},c)}return n.a.createElement("div",{className:Object(O.b)("birthday-action")},!this.props.isSubmitSuccess&&n.a.createElement("div",{className:Object(O.b)("birthday-action__help")},n.a.createElement(M.a,{i18nKey:"defaults.rules.birthday.action_help_text",params:{points:this.props.rule.value}})),this.props.isSubmitSuccess?n.a.createElement("div",{className:Object(O.b)("birthday-action__success")},n.a.createElement(M.a,{i18nKey:"defaults.rules.birthday.success_text",params:{points:this.props.rule.value}})):this.birthdayForm)}},{key:"birthdayForm",get:function(){return n.a.createElement("form",{className:Object(O.b)("birthday-entry-form"),onSubmit:this.handleSubmit},n.a.createElement("div",{className:Object(O.b)("birthday-entry-form__inputs")},n.a.createElement("select",{className:Object(O.b)("birthday-entry-form__select","birthday-entry-form__select--month",this.state.touched.month&&!this.isMonthValid()?"birthday-entry-form__select--error":""),value:this.state.month,onChange:this.handleMonthChange},""===this.state.month?n.a.createElement("option",{key:"-1",value:""},Object(K.d)("ui.dashboard.earn_points.birthday.month")):null,Object(ct.b)(this.props.locale).map(function(e,t){return n.a.createElement("option",{key:t,value:t},Object(B.a)(e))})),n.a.createElement("input",{className:Object(O.b)("birthday-entry-form__input","birthday-entry-form__input--day",this.state.touched.day&&!this.isDayValid()?"birthday-entry-form__input--error":""),type:"text",placeholder:Object(K.d)("ui.dashboard.earn_points.birthday.day"),value:this.state.day,onChange:this.handleDayChange}),n.a.createElement("input",{className:Object(O.b)("birthday-entry-form__input","birthday-entry-form__input--year",this.state.touched.year&&!this.isYearValid()?"birthday-entry-form__input--error":""),type:"text",placeholder:Object(K.d)("ui.dashboard.earn_points.birthday.year"),value:this.state.year,onChange:this.handleYearChange})),n.a.createElement("div",{className:Object(O.b)("birthday-entry-form__invalid-message",!this.state.touched.submit||this.isValid()&&!this.props.submitError?"":"birthday-entry-form__invalid-message--visible")},this.errorMessage),n.a.createElement("button",{type:"submit",className:Object(O.b)("action-button","action-modal__button",this.props.isSubmitting?"action-button--loading":"","birthday-entry-form__submit-button")},n.a.createElement(M.a,{i18nKey:"defaults.rules.birthday.save_button_text"})))}},{key:"errorMessage",get:function(){return this.props.submitError&&"api_error"===this.props.submitError.type?"Sorry, something went wrong":"Please enter a valid date"}},{key:"year",get:function(){return Tr(this.state.year)}},{key:"month",get:function(){return Tr(this.state.month)}},{key:"day",get:function(){return Tr(this.state.day)}}]),t}(n.a.Component),Dr=Object(c.b)(function(e){return{customer:Object(l.j)(e),isSubmitSuccess:e.loyaltyPanel.isCustomerBirthdaySubmitSuccess,isSubmitting:e.loyaltyPanel.isCustomerBirthdaySubmitting,submitError:e.loyaltyPanel.customerBirthdaySubmitError,locale:Object(L.b)(e)}},{reset:U.G,submit:U.C})(Mr);function Ar(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Lr=2e3,Fr=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"likeButtonTimer",void 0),Object(h.a)(Object(J.a)(a),"finishedXfbmlRenderCallback",void 0),Object(h.a)(Object(J.a)(a),"widgetWrapper",void 0),Object(h.a)(Object(J.a)(a),"onFinishedXfmblRender",function(){a.setState({showSpinner:!1,isLikeButtonVisible:!0}),a.likeButtonTimer=window.setTimeout(function(){a.props.setIsEligibleForFacebookLike(!0)},Lr)}),a.state={showSpinner:!0,isLikeButtonVisible:!1},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return this.props.completed?n.a.createElement("div",{className:Object(O.b)("facebook-like__completed")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.like_facebook_success"})):"unavailable"===this.props.facebookSdkState?n.a.createElement("div",{className:Object(O.b)("facebook-like__unavailable")},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.like_facebook_fail"})):n.a.createElement("div",{className:Object(O.b)("facebook-like__wrapper")},n.a.createElement("div",{ref:function(t){return e.widgetWrapper=t}},this.widget),this.state.showSpinner&&n.a.createElement("div",{className:Object(O.b)("standalone-spinner")}))}},{key:"componentDidMount",value:function(){"initial"===this.props.facebookSdkState&&this.props.loadFacebookSdk(),this.facebookInit()}},{key:"componentDidUpdate",value:function(e){"ready"!==e.facebookSdkState&&this.facebookInit()}},{key:"componentWillUnmount",value:function(){this.finishedXfbmlRenderCallback&&this.FB&&this.FB.Event.unsubscribe("xfbml.render",this.finishedXfbmlRenderCallback),this.likeButtonTimer&&clearTimeout(this.likeButtonTimer)}},{key:"facebookInit",value:function(){"ready"===this.props.facebookSdkState&&this.FB&&(this.FB.XFBML.parse(this.widgetWrapper),this.finishedXfbmlRenderCallback||(this.finishedXfbmlRenderCallback=this.onFinishedXfmblRender,this.FB.Event.subscribe("xfbml.render",this.finishedXfbmlRenderCallback)))}},{key:"widget",get:function(){return n.a.createElement("div",{className:"fb-page","data-href":this.props.url,"data-small-header":"true","data-adapt-container-width":"true","data-hide-cover":"false","data-show-facepile":"true"})}},{key:"FB",get:function(){return window.FB}}]),t}(n.a.Component),Br=Object(c.b)(function(e){return{facebookSdkState:Object(Ce.a)(e).sdkState}},function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ar(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ar(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Y.bindActionCreators)({setIsEligibleForFacebookLike:ke.e},e),{loadFacebookSdk:function(){return e(Object(ke.b)("like"))}})})(Fr);var Vr=Object(c.b)(function(e,t){var a=t.siteId;return{site:Object(i.f)(e,a),locale:Object(L.b)(e)}})(function(e){var t=e.site,a=e.siteId,r=e.rule,c=e.locale;if(!t)throw new Error("Could not find site ".concat(a));if(Object(A.u)(r)){var i=r.limitInterval?Object(A.a)(c,r.limitInterval):null;return n.a.createElement("div",{className:Object(O.b)("action-modal__limit-reached")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.completed_already"}),i?n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.complete_again_in",params:{duration:"<strong>".concat(i,"</strong>")}}):null)}return n.a.createElement("div",{className:Object(O.b)("go-to-other-site-action")},n.a.createElement("a",{className:Object(O.b)("action-button","action-modal__button","go-to-other-site-action__button"),href:t.url},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.go_to_other_site.action",params:{store_name:t.name}})))}),Ur=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleClick",function(e){e.preventDefault(),a.props.closeModal(),a.props.changePage("refer")}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:Object(O.b)("referral-action")},n.a.createElement("a",{className:Object(O.b)("action-button","referral-action__button"),onClick:this.handleClick},n.a.createElement(M.a,{i18nKey:"ui.dashboard.menu.refer_friends"})))}}]),t}(n.a.PureComponent),Hr=Object(c.b)(null,{changePage:U.a,closeModal:U.J})(Ur),Wr=function(){return n.a.createElement("div",{className:Object(O.b)("action-modal__description")},"'Thanks for creating an account!'")},qr=function(e){var t=e.rule;return t.description&&0!==t.description.length?n.a.createElement("div",{className:Object(O.b)("action-modal__description"),dangerouslySetInnerHTML:{__html:t.description}}):null},Yr=function(e){var t=e.rule,a=Object(s.e)(Object(r.useCallback)(function(e){return{customer:Object(l.j)(e),locale:Object(L.b)(e)}},[])),c=a.customer,i=a.locale,o=Object(s.d)(),d=Object(r.useCallback)(function(e){return o(U.K({id:t.id,properties:e}))},[o,t.id]),u=!!c&&c.completedRules.some(function(e){return e.ruleId===t.id});if(!t.isForCurrentSite)return n.a.createElement(Vr,{rule:t,siteId:t.siteId});switch(t.kind){case"facebookLike":return n.a.createElement(Br,{completed:u,url:t.properties.facebookLikeUrl});case"twitterFollow":return n.a.createElement(te,{completed:u,onTrigger:d,username:t.properties.twitterHandle,social_name:"twitter"});case"instagramFollow":return n.a.createElement(te,{completed:u,onTrigger:d,username:t.properties.instagramHandle,social_name:"instagram"});case"instagramTagImage":case"instagramPostHashtag":case"foursixtyUgcPost":if(c&&!c.instagramId)return n.a.createElement(Er,null);break;case"birthday":return n.a.createElement(Dr,{rule:t});case"newsletterSignup":return n.a.createElement(Z,{rule:t,completed:u});case"signup":return n.a.createElement(Wr,null);case"custom":return null;case"referral":return n.a.createElement(Hr,null)}if(Object(A.u)(t)){var m=t.limitInterval?Object(A.a)(i,t.limitInterval,{addSuffix:!0}):null;return n.a.createElement("div",{className:Object(O.b)("action-modal__limit-reached")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.completed_already"}),m?n.a.createElement(M.a,{i18nKey:"ui.dashboard.earn_points.complete_again_in",params:{duration:"<strong>".concat(m,"</strong>")}}):null)}return null},Gr=function(){var e=Object(s.e)(Object(r.useCallback)(function(e){return{rule:Object(A.n)(e),customer:Object(l.j)(e)}},[])),t=e.rule,a=e.customer,c=Object(s.d)(),i=function(){return c(U.g())};return n.a.createElement(wa,{isOpen:null!==t,onCloseClick:i,onBackgroundClick:i,title:null==t?void 0:t.displayTitle,className:Object(O.b)("modal--rule-action")},t&&n.a.createElement(n.a.Fragment,null,!a||function(e,t){switch(e.kind){case"instagramPostHashtag":case"instagramTagImage":case"foursixtyUgcPost":return Boolean(t.instagramId)}return!0}(t,a)?n.a.createElement(qr,{rule:t}):null,n.a.createElement(Yr,{rule:t})))};var zr=function(){var e=Object(r.useState)(!0),t=Object(ur.a)(e,2),a=t[0],c=t[1],i=function(){return c(!1)};return n.a.createElement(wa,{isOpen:a,onCloseClick:i,title:"Preview LoyaltyLion"},n.a.createElement("div",{className:Object(O.a)("preview-explainer-modal")},n.a.createElement("p",null,"You're previewing LoyaltyLion on your store."),n.a.createElement("ul",null,n.a.createElement("li",null,"No one can see LoyaltyLion on your store yet except with this link"),n.a.createElement("li",null,"The preview is from the perspective of a logged in customer; you can claim rewards, but they won't provide real voucher codes"),n.a.createElement("li",null,"To reset the preview just refresh this page")),n.a.createElement("a",{className:Object(O.a)("action-button"),onClick:i},"Continue")))},Xr=function(e){var t=e.children;return n.a.createElement("div",{id:Object(O.b)("loyalty-panel-custom-css")},t)};Xr.displayName="AllowCustomCSS";var Jr=function(){var e=Object(s.e)(function(e){return{hasCustomer:Boolean(Object(l.j)(e)),setupPreviewEnabled:Object(o.a)(e)}}),t=e.hasCustomer,a=e.setupPreviewEnabled;return n.a.createElement(u,null,n.a.createElement(Xr,null,n.a.createElement(w,null,t?n.a.createElement(ca,{mode:"modal"}):n.a.createElement(ba,{mode:"modal"})),n.a.createElement($a,null),n.a.createElement(Na,null),t&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Gr,null),n.a.createElement(Ra,null),n.a.createElement(Da,null),n.a.createElement(yr,null),n.a.createElement(jr,null))),n.a.createElement(za,null),n.a.createElement(Ua,null),a&&n.a.createElement(zr,null))},$r=a(37),Zr=a(136),Qr=a(189),en=a(456),tn=Object(c.b)(function(e){var t=Object(A.e)(e);if(!t)throw new en.a("Referral Prompt requires a referral rule");return{points:t.value}},function(e){return{onButtonClick:function(){e(Object(U.q)()),e(Object($r.b)())}}})(function(e){var t=e.points,a=e.onButtonClick;return n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("notification__message")},n.a.createElement(M.a,{i18nKey:"sdk.referral_prompt",params:{points:t}})),n.a.createElement("div",{className:Object(O.b)("notification__action")},n.a.createElement("a",{className:Object(O.b)("notification__action-button","action-button"),tabIndex:0,onClick:a},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.learn_more"}))))}),an=a(110),rn=a.n(an),nn=a(149);var cn=function(e){var t=e.campaign,a=e.currency,r=e.hasCustomer,c=e.localCurrency,i=e.openSplashClick,o=e.trackClick,l=e.rule;return t&&l&&function(e){switch(e.kind){case"hideGuestIntroduction":case"suppress-loyalty-emails":return!1;case"aov_bonus_points":return!0;case"post_purchase_referral_notification":case"post_purchase_signup":return!1}}(t)?n.a.createElement("div",{onClick:o},n.a.createElement("div",{className:Object(O.b)("notification__message")},function(e,t,a,r){switch(e.kind){case"hideGuestIntroduction":case"suppress-loyalty-emails":return null;case"aov_bonus_points":return n.a.createElement("span",{dangerouslySetInnerHTML:{__html:Object(nn.b)(e.options.siteNotificationText,{aov:Object(W.a)(a,r,t.properties.orderValueThreshold/100),points:t.value})}});case"post_purchase_referral_notification":case"post_purchase_signup":return null}}(t,l,a,c)),n.a.createElement("div",{className:Object(O.b)("notification__action")},!r&&n.a.createElement("a",{className:Object(O.b)("notification__action-button","action-button"),tabIndex:0,onClick:i},n.a.createElement(M.a,{i18nKey:"ui.splash.login"})))):null};cn.displayName="CampaignNotificationContent";var on=Object(c.b)(function(e,t){var a=t.notification,r=Object(fa.b)(e,a.campaignId);return{campaign:r,currency:Object(P.a)(e),hasCustomer:Boolean(Object(l.j)(e)),localCurrency:Object(H.c)(e),rule:(null==r?void 0:r.ruleId)&&Object(A.g)(e,r.ruleId)||null}},function(e){return{openSplashClick:function(){e(Object(S.b)()),e(Object($r.b)())},trackClick:rn()(function(){e(Object(pa.a)(Oa.a.ClickedAovCampaignNotification))},1e3,{leading:!0,trailing:!1})}})(cn),ln=Object(c.b)(null,function(e){return{onButtonClick:function(){e(Object(S.b)()),e(Object($r.b)())}}})(function(e){var t=e.onButtonClick;return n.a.createElement("div",null,n.a.createElement("div",{className:Object(O.b)("notification__message")},n.a.createElement(M.a,{i18nKey:"sdk.guest_introduction"})),n.a.createElement("div",{className:Object(O.b)("notification__action")},n.a.createElement("a",{className:Object(O.b)("notification__action-button","action-button"),tabIndex:0,onClick:t},n.a.createElement(M.a,{i18nKey:"ui.referral_popup.learn_more"}))))}),sn=Object(c.b)(null,function(e){return{handleClick:function(){e(Object(U.a)("history")),e(Object(S.b)()),e(Object($r.b)())}}})(function(e){var t=e.message,a=e.handleClick;return n.a.createElement("div",{className:Object(O.b)("notification__message"),onClick:a},t)});var dn=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"handleCloseClick",function(){a.props.onCloseClick&&a.props.onCloseClick()}),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this.props.notification,t=Object(O.b)("notification","notification--".concat(e.kind),"tier"===e.kind&&"notification--point");return n.a.createElement("div",{className:t},n.a.createElement("div",{className:Object(O.b)("notification__content")},function(e){switch(e.kind){case"point":case"tier":return n.a.createElement(sn,{message:e.message});case"referral-prompt":return n.a.createElement(tn,null);case"guest-introduction":return n.a.createElement(ln,null);case"campaign":return n.a.createElement(on,{notification:e})}}(e)),n.a.createElement("a",{className:Object(O.b)("notification__close-button"),tabIndex:0,onClick:this.handleCloseClick},""))}}]),t}(n.a.PureComponent);Object(h.a)(dn,"displayName","NotificationItem");var un=function(e){var t=e.notifications,a=e.backgroundColor,r=e.onClose,c={backgroundColor:a,color:a};return 0===t.length?null:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.b)("notification-container","notification-container--on-widget")},n.a.createElement("div",{style:c,className:Object(O.b)("notification-list")},n.a.createElement("div",{onClick:r,className:Object(O.b)("notification-list__close")},""),t.map(function(e){return n.a.createElement(dn,{key:e.id,notification:e})}))))};un.displayName="WidgetNotifications";var mn=Object(c.b)(function(e){return{backgroundColor:Object(Qr.a)(e).backgroundColors.standard.replace(")",", 0.85)").replace("rgb","rgba"),notifications:Object(Zr.e)(e).map(function(t){return Object(Zr.a)(e,t)})}},{onClose:$r.b})(un),bn=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.notifications,r=t.position;return t.showOnWidget?n.a.createElement(u,null,n.a.createElement(mn,null)):n.a.createElement(u,null,n.a.createElement(Xr,null,n.a.createElement(Ea.TransitionGroup,{appear:!0,className:Object(O.b)("notification-container",r&&"notification-container--".concat(Object(B.b)(r)))},a.map(function(t){return n.a.createElement(Ea.CSSTransition,{appear:!0,unmountOnExit:!0,timeout:200,key:t.id,classNames:{appear:Object(O.b)("notification--enter"),appearActive:Object(O.b)("notification--enter-active"),enter:Object(O.b)("notification--enter"),enterActive:Object(O.b)("notification--enter-active"),exit:Object(O.b)("notification--exit"),exitActive:Object(O.b)("notification--exit-active")}},n.a.createElement(dn,{notification:t,onCloseClick:function(){return e.props.deleteNotification(t.id)}}))}))))}}]),t}(n.a.PureComponent);Object(h.a)(bn,"displayName","NotificationContainer");var pn=Object(c.b)(function(e){return{notifications:Object(Zr.e)(e).map(function(t){return Object(Zr.a)(e,t)}),position:Object(Zr.d)(e),showOnWidget:Object(Qr.a)(e).enabled}},{deleteNotification:$r.c})(bn),fn=a(445);function On(e){return e.getAttribute("data-lion-class")||""}var _n=function(e){var t=e.background,a=e.block,r=e.element,c=e.titleKey,i=e.className;return n.a.createElement("div",{className:Object(O.a)("".concat(a,"__header"),"integrated-page-section__header",i),style:t?{background:t}:void 0},n.a.createElement(r,{},n.a.createElement(M.a,{i18nKey:c})),n.a.createElement("div",{className:Object(O.a)("integrated-page-section__header-underline")}))},jn=function(e){var t=e.showHeader,a=e.headerOptions;return n.a.createElement("div",{className:Object(O.a)("account-history","integrated-page-section")},t&&n.a.createElement(_n,Object(Ae.a)({block:"account-history"},a,{titleKey:"sdk.integrated_page.account_history.header"})),n.a.createElement(he,{mode:"integrated"}))},hn=function(e){var t=e.showHeader,a=e.headerOptions;if(!Object(c.c)(l.j))return null;var r="available-rewards";return n.a.createElement("div",{className:Object(O.a)(r,"integrated-page-section")},t&&n.a.createElement(_n,Object(Ae.a)({block:r},a,{titleKey:"sdk.integrated_page.available_rewards.header"})),n.a.createElement(st,{mode:"integrated",showUsed:!1}))},yn=function(e){var t=e.showHeader,a=e.headerOptions;return n.a.createElement("div",{className:Object(O.a)("earn","integrated-page-section")},t&&n.a.createElement(_n,Object(Ae.a)({block:"earn"},a,{titleKey:"sdk.integrated_page.earn.header"})),n.a.createElement(ue,{mode:"integrated"}))},vn=function(e){var t=e.showHeader,a=e.headerOptions;return n.a.createElement("div",{className:Object(O.a)("redeem","integrated-page-section")},t&&n.a.createElement(_n,Object(Ae.a)({block:"redeem"},a,{titleKey:"sdk.integrated_page.redeem.header"})),n.a.createElement(xt,{mode:"integrated"}))},En=function(e){var t=e.tier;return n.a.createElement("ul",{className:Object(O.b)("tier-benefits-list")},t.benefits.map(function(e){return n.a.createElement("li",{key:e.id,className:Object(O.b)("tier-benefits-list__item")},e.content)}))};En.displayName="TierBenefitsList";var gn=function(e){var t=e.fill;return t<0&&(t=0),t>1&&(t=1),n.a.createElement("div",{className:Object(O.b)("progress-bar__container")},n.a.createElement("div",{className:Object(O.b)("progress-bar__fill"),style:{width:"".concat(Math.round(100*t),"%")}}))};gn.displayName="ProgressBar";var wn=function(e){var t=e.expiresAt;return t?n.a.createElement("div",{className:Object(O.b)("tier-box__expiry")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.user_tier_info_expiry",params:{expires_at:t}})):null},kn=function(e){var t=e.currency,a=e.nextTier,r=e.tier;switch(e.tiersMode){case"points":return r.pointsToNextTier?n.a.createElement("div",{className:Object(O.b)("tier-box__value-to-next")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.earn_amount_for_next_tier",params:{needed_points:r.pointsToNextTier,tier_name:a.name}})):null;case"spend":return r.spendToNextTier?n.a.createElement("div",{className:Object(O.b)("tier-box__value-to-next")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.spend_amount_for_next_tier",params:{needed_spend:Object(W.a)(t,null,r.spendToNextTier),tier_name:a.name}})):null}},Nn=function(){return n.a.createElement("div",{className:Object(O.b)("tier-box__condition-text")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.conditions_for_tier"}))},Cn=function(e){var t=e.currency,a=e.nextTier,r=e.tier,c=e.tiersMode;return r.isCurrent?n.a.createElement("div",{className:Object(O.b)("tier-box__footer tier-box__footer--current")},n.a.createElement("div",{className:Object(O.b)("tier-box__you-are-here")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.you_are_here"})),r.expiresAt&&n.a.createElement(wn,{expiresAt:r.expiresAt}),a&&null!==r.progressToNextTier&&null===r.conditions&&n.a.createElement(n.a.Fragment,null,n.a.createElement(kn,{currency:t,tier:r,nextTier:a,tiersMode:c}),n.a.createElement(gn,{fill:r.progressToNextTier}))):n.a.createElement("div",{className:Object(O.b)("tier-box__footer")},null!==r.conditions&&n.a.createElement(Nn,null))};Cn.displayName="TierBoxFooter";var Sn=Object(c.b)(function(e){return{currency:Object(P.a)(e)}})(Cn),Pn=function(e){var t=e.currency,a=e.tier,r=e.tiersMode;if(a.conditions)return null;if(a.default)return n.a.createElement("div",{className:Object(O.b)("tier-box__sub-title")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.start_here"}));switch(r){case"points":return n.a.createElement("div",{className:Object(O.b)("tier-box__sub-title")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.reach_points",params:{amount:a.bounds.lower}}));case"spend":return n.a.createElement("div",{className:Object(O.b)("tier-box__sub-title")},n.a.createElement(M.a,{i18nKey:"ui.dashboard.tiers.spend_amount",params:{amount:Object(W.a)(t,null,a.bounds.lower/100)}}))}},Kn=function(e){var t=e.currency,a=e.tier,r=e.tiersMode;return n.a.createElement("div",{className:Object(O.b)("tier-box__header")},n.a.createElement("div",{className:Object(O.b)("tier-box__position")},a.position),n.a.createElement("div",{className:Object(O.b)("tier-box__accent"),style:a.colour?{backgroundColor:a.colour}:{}}),n.a.createElement("div",{className:Object(O.b)("tier-box__title")},a.name),n.a.createElement(Pn,{currency:t,tier:a,tiersMode:r}))};Kn.displayName="TierBoxHeader";var In=Object(c.b)(function(e){return{currency:Object(P.a)(e)}})(Kn),Rn=function(e){var t=e.tier.ruleOverrides.find(function(e){return"purchase"===e.rule.kind});return t?n.a.createElement("div",{className:Object(O.b)("tier-box__purchase-rule")},n.a.createElement(q,{isPerUnit:!0,points:t.value})):null},xn=function(e){var t=e.className,a=e.hasCustomer,r=e.tiersMode,c=e.nextTier,i=e.tier;return i?n.a.createElement("div",{className:Object(O.b)("tier-box tier-box--".concat(i.position),{"tier-box--guest":!a,"tier-box--previous":i.isPrevious,"tier-box--current":i.isCurrent,"tier-box--next":i.isNext})+" ".concat(t||"")},n.a.createElement(In,{tier:i,tiersMode:r}),n.a.createElement(Rn,{tier:i}),n.a.createElement(En,{tier:i}),n.a.createElement(Sn,{tier:i,nextTier:c,tiersMode:r})):null};xn.displayName="TierBox";var Tn=Object(c.b)(function(e,t){return{hasCustomer:Boolean(Object(l.j)(e)),tiersMode:Object(i.j)(e).loyaltyTiersMode,tier:Object(Bt.c)(e,t.tierId),nextTier:Object(Bt.e)(e,t.tierId)}})(xn),Mn=function(e){var t=e.className,a=e.hasCustomer,r=e.tierIds;return n.a.createElement("div",{className:Object(O.b)("tier-overview",{"tier-overview--guest":!a})+" ".concat(t||"")},r.map(function(e){return n.a.createElement(Tn,{key:e,tierId:e})}))};Mn.displayName="TierOverview";var Dn=Object(c.b)(function(e){var t=Boolean(Object(l.j)(e));return Object(Bt.a)(e)?{tierIds:Object(Bt.f)(e),hasCustomer:t}:(V.a.warn("Invalid Tiers: tiers are either disabled or all hidden"),{tierIds:[],hasCustomer:t})})(Mn),An=function(e){var t=e.showHeader,a=e.headerOptions;return n.a.createElement("div",{className:Object(O.a)("tiers-overview","integrated-page-section")},t&&n.a.createElement(_n,Object(Ae.a)({block:"tiers-overview"},a,{titleKey:"sdk.integrated_page.tiers_overview.header"})),n.a.createElement(Dn,null))},Ln=function(e){var t=e.showIntroText,a=e.showPendingPoints,o=e.background,s=Object(c.c)(l.j),d=Object(c.c)(i.i).name,u=Object(r.useMemo)(function(){if(s){var e=Object(l.a)(s);return n.a.createElement(Fn,{name:s.firstName,pendingPoints:s.pointsPending,programName:d,showIntroText:t,showPending:a,totalPoints:e})}return n.a.createElement(Bn,null)},[s,d,t,a]);return n.a.createElement("div",{className:Object(O.a)("welcome","integrated-page-section"),style:o?{background:o}:void 0},u)},Fn=function(e){var t=e.name,a=e.pendingPoints,r=e.programName,c=e.showIntroText,i=e.showPending,o=e.totalPoints;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.a)("welcome__welcome-back")},n.a.createElement("h2",null,n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_member.welcome_back",params:{name:t}}))),n.a.createElement("div",{className:Object(O.a)("welcome__your-points")},n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_member.you_have_points",params:{smart_count:o}})),i&&n.a.createElement("div",{className:Object(O.a)("welcome__pending-points")},n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_member.pending",params:{points:a}})),c&&n.a.createElement("div",{className:Object(O.a)("welcome__intro-text")},n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_member.intro_text",params:{program_name:r}})))},Bn=function(){var e=Object(c.c)(A.r),t=Object(c.c)(F.a).urls,a=t.login,r=t.signup,o=Object(c.c)(i.i).name;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:Object(O.a)("welcome__join-today")},e>0?n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_guest.join_points",params:{smart_count:e,program_name:o}}):n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_guest.join_no_points"})),n.a.createElement("a",{href:r,className:Object(O.a)("welcome__signup-link")},n.a.createElement(M.a,{i18nKey:"sdk.integrated_page.welcome_guest.signup_link",params:{program_name:o}})),n.a.createElement(M.a,{className:Object(O.a)("welcome__login-link"),i18nKey:"sdk.integrated_page.welcome_guest.already_member",params:{login_url:a}}))},Vn=function(e){var t,a=e.className,r=Object(c.c)(F.c),i=Object(c.c)(l.j);return n.a.createElement("div",{className:Object(O.a)(a,"integrated-page",(t={},Object(h.a)(t,"integrated-page--guest",!i),Object(h.a)(t,"integrated-page--authenticated",Boolean(i)),t))},r.sections.map(function(e,t){return n.a.createElement(Un,{key:t,section:e})}))},Un=function(e){var t=e.section;switch(t.kind){case"accountHistory":return n.a.createElement(jn,t.options);case"availableRewards":return n.a.createElement(hn,t.options);case"earn":return n.a.createElement(yn,t.options);case"redeem":return n.a.createElement(vn,t.options);case"tiersOverview":return n.a.createElement(An,t.options);case"welcome":return n.a.createElement(Ln,t.options)}},Hn=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(Vn,{className:a}))},Wn=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(he,{mode:"integrated",className:a}))};Wn.displayName="HistoryTablePortal";var qn=Object(c.b)(function(e){return{guest:!Object(l.j)(e)}})(function(e){var t=e.guest?"https://loyaltylion.com/healthandwellness?utm_source=Poweredby&utm_medium=healthwellness&utm_campaign=loggedout":"https://loyaltylion.com/healthandwellness?utm_source=Poweredby&utm_medium=healthwellness&utm_campaign=loggedin";return n.a.createElement("div",{className:Ge()(Object(O.b)("powered-by"))},n.a.createElement("a",{href:t,target:"_blank"},"Powered by LoyaltyLion"))}),Yn=function(e){var t=e.element;return n.a.createElement(fn.a,{node:t},n.a.createElement(qn,null))};Yn.displayName="PoweredByPortal";var Gn=function(e){var t=e.element;return n.a.createElement(fn.a,{node:t},n.a.createElement(st,{mode:"integrated"}))};Gn.displayName="ClaimedRewardsListPortal";var zn=a(43),Xn=a(197),Jn=function(e){function t(){var e,a;Object(_.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return a=Object(k.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(n))),Object(h.a)(Object(J.a)(a),"buttonRef",null),Object(h.a)(Object(J.a)(a),"handleClick",function(){var e=Object(X.a)(z.a.mark(function e(t){var r,n;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=a.props.reward){e.next=4;break}return e.abrupt("return");case 4:if(n=a.props.variantId?parseInt(a.props.variantId,10):void 0,!a.active){e.next=11;break}return e.next=8,a.props.redeemFreeProductReward({id:r.id,variantId:n});case 8:if(a.buttonRef){e.next=10;break}throw new Error("buttonRef is null");case 10:Object(zn.b)({event:"seamlessProductReward:complete",payload:a.buttonRef});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.productId,r=t.reward,c=t.variantId;return r?r.options.productVariants.length>1&&!c?(V.a.error("InCartReward: ".concat(r.id," with multiple variants must pass a variantId to InCartRewardButton")),null):n.a.createElement("button",{ref:function(t){return e.buttonRef=t},className:this.classes,onClick:this.handleClick,"data-lion-inactive":this.inactive||null,"data-lion-active":this.active||null,"data-lion-redeemed":this.props.disabledAlreadyRedeemed||null,"data-lion-working":this.working||null,disabled:this.inactive||void 0},this.getContent()):(V.a.info("Buy with points button found but no matching reward for product id: "+"".concat(a)),null)}},{key:"getContent",value:function(){var e=this.props,t=e.buyWithPointsStatus,a=e.disabledNeedPaidItems,r=e.disabledAlreadyRedeemed,c=e.outOfStock,i=e.points,o=e.reward;if(!o)return"";if("started"!==t)return n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.buy_with_points",params:{points:o.cost}});if(r)return n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.already_redeemed"});if(a)return n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.paid_items_required"});if(this.canAfford)return c?n.a.createElement(M.a,{i18nKey:"ui.dashboard.redeem_points.out_of_stock"}):n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.buy_with_points",params:{points:o.cost}});var l=o.cost-i;return n.a.createElement(M.a,{i18nKey:"sdk.seamless_product_reward.need_more_points",params:{points:l,total_cost:o.cost}})}},{key:"classes",get:function(){var e=this.props,t=e.className,a=e.disabledAlreadyRedeemed;return Ge()(Object(O.a)("in-cart-reward__button","action-button",{"action-button--loading":this.working,"action-button--disabled":!this.working&&this.inactive,"action-button--redeemed":a}),t||!1,!!this.inactive&&"disabled")}},{key:"active",get:function(){return!this.inactive&&!this.working}},{key:"canAfford",get:function(){var e=this.props,t=e.points,a=e.reward;return!!a&&t>=a.cost}},{key:"inactive",get:function(){var e=this.props,t=e.disabledNeedPaidItems,a=e.disabledAlreadyRedeemed,r=e.outOfStock;return"started"!==e.buyWithPointsStatus||t||a||r||!this.canAfford}},{key:"working",get:function(){var e=this.props.reward;return!!e&&e.id===this.props.redeemingRewardFor}}]),t}(n.a.PureComponent),$n=Object(c.b)(function(e,t){return{buyWithPointsStatus:Object(H.b)(e),disabledAlreadyRedeemed:Object(kt.a)(e,t.productId),disabledNeedPaidItems:Object(i.k)(e)&&!Object(kt.i)(e),outOfStock:Object(kt.d)(e,t.productId),points:Object(Xn.a)(e),redeemingRewardFor:Object(x.i)(e),reward:Object(ut.c)(e,t.productId)}},function(e){return{redeemFreeProductReward:function(t){return e(Object(U.t)(t))}}})(Jn),Zn=function(e){var t=e.element,a=e.productId,r=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement($n,{className:r,productId:a}))};Zn.displayName="InCartRewardButtonPortal";var Qn=function(e){var t=e.variants,a=e.value,r=e.onChange;return n.a.createElement("select",{className:Object(O.b)("in-cart-rewards-widget-item__variant-selector"),onChange:r,value:a},t.map(function(e){return n.a.createElement("option",{key:e.position,value:e.id},e.title)}))},ec=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"handleSelectVariantChange",function(e){e.persist(),a.setState({selectedVariantId:e.target.value})}),a.state={selectedVariantId:e.reward?e.reward.options.productVariants[0].id:""},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"componentWillReceiveProps",value:function(e){""===this.state.selectedVariantId&&e.reward&&this.setState({selectedVariantId:e.reward.options.productVariants[0].id})}},{key:"render",value:function(){var e=this.props.reward,t=this.state.selectedVariantId;return e?n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget-item")},n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget-item__picture")},n.a.createElement("img",{src:e.options.productImageUrl,alt:"Photo of ".concat(e.displayTitle)})),n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget-item__name")},e.displayTitle),e.options.productVariants.length>1?n.a.createElement(Qn,{value:t,variants:e.options.productVariants,onChange:this.handleSelectVariantChange}):null,n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget-item__cost"),dangerouslySetInnerHTML:{__html:e.costText}}),n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget-item__button")},n.a.createElement($n,{productId:e.options.productId,variantId:t}))):null}}]),t}(n.a.PureComponent),tc=Object(c.b)(function(e,t){return{reward:Object(ut.b)(e,t.rewardId)}})(ec),ac=function(e){function t(e){var a;return Object(_.a)(this,t),a=Object(k.a)(this,Object(N.a)(t).call(this,e)),Object(h.a)(Object(J.a)(a),"pageForward",function(e){e.preventDefault(),a.setState(function(e){var t=e.page;return{page:t===a.props.lastPage?t:t+1}})}),Object(h.a)(Object(J.a)(a),"pageBackward",function(e){e.preventDefault(),a.setState(function(e){var t=e.page;return{page:0===t?t:t-1}})}),a.state={page:0},a}return Object(C.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){Object(zn.b)({event:"redemptionWidget:rendered"})}},{key:"render",value:function(){var e=this.props.inCartRewardIds,t=this.state.page,a=this.props.className||"";return e.length>0?n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget")+" "+a},n.a.createElement("div",{className:Object(O.a)("in-cart-rewards-widget__rewards-slider"),style:{left:"".concat(-1*t*100,"%")}},e.map(function(e){return n.a.createElement(tc,{rewardId:e,key:e})})),n.a.createElement("a",{href:"#",className:Object(O.a)("in-cart-rewards-widget__navigator","in-cart-rewards-widget__navigator--back",{"in-cart-rewards-widget__navigator--hidden":0===t}),onClick:this.pageBackward},""),n.a.createElement("a",{href:"#",className:Object(O.a)("in-cart-rewards-widget__navigator","in-cart-rewards-widget__navigator--forward",{"in-cart-rewards-widget__navigator--hidden":t===this.props.lastPage}),onClick:this.pageForward},"")):null}}]),t}(n.a.PureComponent);Object(h.a)(ac,"displayName","InCartRewardsWidget");var rc=Object(c.b)(function(e){var t=Object(ut.d)(e);return{inCartRewardIds:t,lastPage:t.length-1}})(ac),nc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(rc,{className:a}))};nc.displayName="InCartRewardsWidgetPortal";var cc=function(e){var t=e.element;return n.a.createElement(fn.a,{node:t},n.a.createElement(xt,{mode:"integrated"}))};cc.displayName="RewardsListPortal";var ic=function(e){var t=e.element,a=On(t),r=t.getAttribute("data-lion-style")||"";return n.a.createElement(fn.a,{node:t},n.a.createElement(ue,{mode:"integrated",requestedStyle:r,className:a}))};ic.displayName="RulesListPortal";var oc=function(e){var t=e.className,a=e.tierName;return null===a?null:n.a.createElement("span",{className:t},a)};oc.displayName="CurrentTierName";var lc=Object(c.b)(function(e){if(!Object(Bt.a)(e))return V.a.warn("Invalid Tiers: tiers are either disabled or all hidden"),{tierName:null};var t=Object(l.f)(e);return t||V.a.warn("Unable to render current-tier-name - customer has no tier"),{tierName:t?t.name:null}})(oc),sc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(lc,{className:a}))};sc.displayName="CurrentTierNamePortal";var dc=function(e){var t=e.kind,a=e.tiers;return n.a.createElement("thead",{className:Object(O.b)("tier-compare__header","tier-compare__header--".concat(t))},n.a.createElement("tr",null,n.a.createElement("th",{className:Object(O.b)("tier-compare__header-cell")}),a.map(function(e){return n.a.createElement("th",{key:e.id,className:Object(O.b)("tier-compare__header-cell","tier-compare__header-cell--tier-".concat(e.position),{"tier-compare__header-cell--current":e.isCurrent})},e.name)})))};dc.displayName="TierCompareHeader";var uc=function(e){var t=e.enabled,a=e.color;return t?n.a.createElement("div",{className:Object(O.b)("tier-benefits-compare__benefit-status-circle"),style:a?{backgroundColor:a}:{}}):n.a.createElement("div",{className:Object(O.b)("tier-benefits-compare__benefit-status-cross")})},mc=function(e){var t=e.benefit,a=e.tiers;return n.a.createElement("tr",{className:Object(O.b)("tier-benefits-compare__row")},n.a.createElement("td",{className:Object(O.b)("tier-benefits-compare__row-cell","tier-benefits-compare__benefit-text")},t.content),a.map(function(e){var a=Object(ie.c)(t.loyaltyTierIds,e.id);return n.a.createElement("td",{key:e.id,className:Object(O.b)("tier-benefits-compare__row-cell","tier-benefits-compare__row-cell--tier-".concat(e.position),"tier-benefits-compare__benefit-status",{"tier-benefits-compare__benefit-status--enabled":a,"tier-benefits-compare__benefit-status--current":e.isCurrent})},n.a.createElement(uc,{enabled:a,color:e.colour}))}))};mc.displayName="TierBenefitsCompareRow";var bc=function(e){var t=e.benefits,a=e.className,r=e.tiers;return n.a.createElement("div",{className:Object(O.b)("tier-benefits-compare")+" ".concat(a||"")},n.a.createElement("table",null,n.a.createElement(dc,{kind:"benefits",tiers:r}),n.a.createElement("tbody",null,t.map(function(e){return n.a.createElement(mc,{key:e.id,benefit:e,tiers:r})}))))};bc.displayName="TierBenefitsCompare";var pc=Object(c.b)(function(e){return{benefits:Object(Bt.b)(e),tiers:Object(Bt.g)(e)}})(bc),fc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(pc,{className:a}))};fc.displayName="TierBenefitsComparePortal";var Oc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(Dn,{className:a}))};Oc.displayName="TierOverviewPortal";var _c=function(e){var t=e.reward,a=e.tiers;return n.a.createElement("tr",{className:Object(O.b)("tier-rewards-compare__row","tier-rewards-compare__row--reward-".concat(t.id))},n.a.createElement("td",{className:Object(O.b)("tier-rewards-compare__row-cell","tier-rewards-compare__reward-title")},n.a.createElement("span",{dangerouslySetInnerHTML:{__html:t.displayTitle}})),a.map(function(e){return n.a.createElement("td",{key:e.id,className:Object(O.b)("tier-rewards-compare__row-cell","tier-rewards-compare__row-cell--tier-".concat(e.position),"tier-rewards-compare__reward-cost",{"tier-rewards-compare__row-cell--current":e.isCurrent})},function(e,t){var a=t.rewardOverrides.find(function(t){return t.rewardId===e.id});return a?a.enabled?a.cost:null:e.cost}(t,e))}))};_c.displayName="TierRewardsCompareRow";var jc=function(e){var t=e.className,a=e.rewards,r=e.tiers;return n.a.createElement("div",{className:Object(O.b)("tier-rewards-compare")+" ".concat(t||"")},n.a.createElement("table",null,n.a.createElement(dc,{kind:"rewards",tiers:r}),n.a.createElement("tbody",null,a.map(function(e){return n.a.createElement(_c,{key:e.id,tiers:r,reward:e})}))))};jc.displayName="TierRewardsCompare";var hc=Object(c.b)(function(e){return{tiers:Object(Bt.g)(e),rewards:Object(ut.m)(e)}})(jc),yc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(hc,{className:a}))};yc.displayName="TierRewardsComparePortal";var vc=function(e){var t=e.rule,a=e.tiers;return n.a.createElement("tr",{className:Object(O.b)("tier-rules-compare__row","tier-rules-compare__row--rule-".concat(t.id))},n.a.createElement("td",{className:Object(O.b)("tier-rules-compare__row-cell","tier-rules-compare__rule-title")},n.a.createElement("span",{dangerouslySetInnerHTML:{__html:t.displayTitle}})),a.map(function(e){return n.a.createElement("td",{key:e.id,className:Object(O.b)("tier-rules-compare__row-cell","tier-rules-compare__row-cell--tier-".concat(e.position),"tier-rules-compare__rule-value",{"tier-rules-compare__row-cell--current":e.isCurrent})},function(e,t){var a=t.ruleOverrides.find(function(t){return t.ruleId===e.id});return a?a.enabled?a.value:null:e.value}(t,e))}))};vc.displayName="TierRulesCompareRow";var Ec=function(e){var t=e.className,a=e.rules,r=e.tiers;return n.a.createElement("div",{className:Object(O.b)("tier-rules-compare")+" ".concat(t||"")},n.a.createElement("table",null,n.a.createElement(dc,{kind:"rules",tiers:r}),n.a.createElement("tbody",null,a.map(function(e){return n.a.createElement(vc,{key:e.id,tiers:r,rule:e})}))))};Ec.displayName="TierRulesCompare";var gc=Object(c.b)(function(e){return{tiers:Object(Bt.g)(e),rules:Object(A.p)(e)}})(Ec),wc=function(e){var t=e.element,a=On(t);return n.a.createElement(fn.a,{node:t},n.a.createElement(gc,{className:a}))};wc.displayName="TierRulesComparePortal";var kc=function(e){return n.a.createElement(fn.a,{node:e.element},n.a.createElement(u,null,n.a.createElement(Xr,null,e.hasCustomer?n.a.createElement(ca,{mode:"embed"}):n.a.createElement(ba,{mode:"embed"}))))};kc.displayName="AccountEmbedPortal";var Nc=Object(c.b)(function(e){return{hasCustomer:Boolean(Object(l.j)(e))}})(kc),Cc=a(97),Sc=a(59),Pc=function(e){var t=e.isAffordable,a=e.isEligible,r=e.hasRedeemed,c=e.costString;return r?n.a.createElement(M.a,{i18nKey:"sdk.checkout_redemption.remove"}):a?t?n.a.createElement(n.a.Fragment,null,n.a.createElement(M.a,{i18nKey:"sdk.checkout_redemption.redeem_for"}),n.a.createElement("span",{dangerouslySetInnerHTML:{__html:c}})):n.a.createElement(M.a,{i18nKey:"sdk.checkout_redemption.insufficient_points"}):n.a.createElement(n.a.Fragment,null,"Redeem")},Kc=function(){var e=Object(s.e)(Object(r.useCallback)(function(e){var t=Object(Cc.i)(e),a=t.isApplying,r=t.isRemoving;return{isAffordable:Object(Cc.k)(e),currency:Object(P.a)(e),localCurrency:Object(H.c)(e),hasRedeemed:Object(Cc.c)(e),redeemPrice:Object(Cc.a)(e),isLoading:a||r,isEligible:Object(Cc.j)(e)}},[])),t=e.currency,a=e.localCurrency,c=e.hasRedeemed,i=e.isAffordable,o=e.redeemPrice,l=e.isLoading,d=e.isEligible,u=Object(s.d)(),m=Object(r.useCallback)(function(){return u(Object(Sc.d)())},[u]),b=Object(r.useCallback)(function(){return u(Object(Sc.b)())},[u]),p=" ".concat(Object(W.a)(t,a,o)),f=l||!d?function(){}:c?m:b,O=l||!d||!c&&!i,_=i&&d&&!c?"default":"disabled";return n.a.createElement("button",{className:Ge()("field__input-btn","btn","btn--".concat(_),{"btn--loading":l}),onClick:f,disabled:O},n.a.createElement("span",{className:"btn__content visually-hidden-on-mobile"},n.a.createElement(Pc,{isAffordable:i,isEligible:d,hasRedeemed:c,costString:p})),function(e){var t=e.isLoading,a=e.hasRedeemed;return n.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon-svg shown-on-mobile",opacity:t?0:1,style:{transition:"opacity 0.3s"},viewBox:"0 0 14 14",width:"16",height:"16","aria-hidden":"true",focusable:"false"},a?n.a.createElement("path",{stroke:"white",strokeWidth:"1.7",d:"M0,0 L14,14 M14,0 L0,14"}):n.a.createElement("use",{xlinkHref:"#arrow"}))}({isLoading:l,hasRedeemed:c}),n.a.createElement("i",{style:{opacity:l?1:0},className:"btn__spinner icon icon--button-spinner"}),n.a.createElement("svg",{className:"icon-svg icon-svg--size-18 btn__spinner icon-svg--spinner-button","aria-hidden":"true",focusable:"false"},n.a.createElement("use",{xlinkHref:"#spinner-button"})))};function Ic(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}var Rc=function(){for(var e=Object(s.e)(Object(r.useCallback)(function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ic(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ic(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},Object(Cc.e)(e),{currency:Object(P.a)(e),localCurrency:Object(H.c)(e)})},[])),t=e.disabled,a=e.max,c=e.min,i=e.step,o=e.value,l=e.pointsPerUnit,d=e.currency,u=e.localCurrency,m=Object(s.d)(),b=Object(r.useCallback)(function(e){return m(Sc.a.setRedemptionValue(parseInt(e.target.value,10)))},[m]),p=[],f=a;f>=c;f-=i)p.push(n.a.createElement("option",{key:f,value:f},Object(K.d)("sdk.checkout_redemption.value_select_option",{smart_count:l*f,amount:Object(W.b)(d,u,f)})));return n.a.createElement("div",{className:"field__input-wrapper field__input-wrapper--select"},n.a.createElement("select",{"data-testid":"checkout-redemption-select",className:"field__input field__input--select",disabled:t,value:o,onChange:b},p),n.a.createElement("div",{className:"field__caret"},n.a.createElement("svg",{className:"icon-svg icon-svg--color-adaptive-lighter icon-svg--size-10 field__caret-svg","aria-hidden":"true",focusable:"false"},n.a.createElement("use",{xlinkHref:"#caret-down"}))))},xc={WebkitAppearance:"slider-horizontal",MozAppearance:"range",appearance:"slider-horizontal",padding:"0.94em 0.5em",width:"100%"},Tc=function(){var e=Object(s.e)(Object(r.useCallback)(Cc.e,[])),t=e.disabled,a=e.max,c=e.min,i=e.step,o=e.value,l=Object(s.d)(),d=Object(r.useCallback)(function(e){return l(Sc.a.setRedemptionValue(parseInt(e.target.value,10)))},[l]);return n.a.createElement("input",{style:xc,disabled:t,max:a,min:c,value:o,step:i,onChange:d,type:"range"})},Mc=function(){var e=Object(s.e)(Object(r.useCallback)(function(e){return Object(Cc.d)(e)},[]));return n.a.createElement("div",{className:"field__input-btn-wrapper"},"select"===e?n.a.createElement(Rc,null):n.a.createElement(Tc,null),n.a.createElement(Kc,null))},Dc=function(){var e=Object(s.e)(Object(r.useCallback)(function(e){return{currency:Object(P.a)(e),isAffordable:Object(Cc.k)(e),inputMode:Object(Cc.d)(e),eligibleTotal:Object(Cc.b)(e),minimumPoints:Object(Cc.f)(e),hasRedeemed:Object(Cc.c)(e),checkoutReward:Object(ut.f)(e)}},[])),t=e.currency,a=e.isAffordable,c=e.inputMode,i=e.eligibleTotal,o=e.minimumPoints,l=e.hasRedeemed,d=e.checkoutReward,u=d?function(e){var t=e.options,a=t.appliesToCollectionId,r=t.collectionRestrictionText;if(!a)return"";if(r)return r;return Object(K.d)("sdk.checkout_redemption.generic_collection_restriction_text")}(d):"";return 0===i?function(e,t){var a=da(Object(K.d)("sdk.checkout_redemption.help_text_zero_eligible_total",{amount:Object(W.b)(e,null,0)}),t);return n.a.createElement("span",{style:Ac.unaffordable,"data-testid":"help-text",className:Object(O.a)("checkout-redemption__header__help-text")},a)}(t,u):l||a?function(e,t){return n.a.createElement("span",{style:Ac.affordable,"data-testid":"help-text",className:Object(O.a)("checkout-redemption__header__help-text")},da(function(e){switch(e){case"slider":return Object(K.d)("sdk.checkout_redemption.help_text");case"select":return Object(K.d)("sdk.checkout_redemption.help_text_select_box")}}(e),t))}(c,u):function(e){return n.a.createElement("span",{style:Ac.unaffordable,"data-testid":"help-text",className:Object(O.a)("checkout-redemption__header__help-text")},n.a.createElement(M.a,{i18nKey:"sdk.checkout_redemption.help_text_insufficient_points",params:{minimum_points:e}}))}(o)},Ac={affordable:{color:"#969696",display:"block",margin:" 0.53em 0px 1.3em"},unaffordable:{color:"#a00a00",display:"block",margin:"0.53em 0 1.3em"}};var Lc={header:{color:"#4b4b4b",fontSize:"1.14286em"}},Fc=function(){var e=Object(s.e)(Object(r.useCallback)(function(e){return{approvedPoints:Object(l.h)(e).approved}},[])).approvedPoints;return n.a.createElement(n.a.Fragment,null,n.a.createElement("table",{className:Object(O.b)("checkout-redemption__header")},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",{className:Object(O.b)("checkout-redemption__header__title"),style:Lc.header},n.a.createElement(M.a,{i18nKey:"sdk.checkout_redemption.redeem_points"})),n.a.createElement("td",{className:Object(O.b)("checkout-redemption__header__points")},n.a.createElement(Jt,{points:e})," ",n.a.createElement(M.a,{i18nKey:"sdk.points"}))))),n.a.createElement(Dc,null))},Bc=function(e){var t=e.element;return Object(s.e)(Object(r.useCallback)(Cc.g,[]))?n.a.createElement(fn.a,{node:t},n.a.createElement("div",{className:"fieldset"},n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:Object(O.b)("checkout-redemption")},n.a.createElement(Fc,null),n.a.createElement(Mc,null))))):null};Bc.displayName="CheckoutRedemptionPortal";var Vc=Object(c.b)(function(e){return{backgroundColor:Object(Qr.a)(e).backgroundColors.dark,totalPoints:Object(l.h)(e).total}})(function(e){var t=e.totalPoints,a={backgroundColor:e.backgroundColor};return n.a.createElement("span",{className:Object(O.b)("loyalty-widget__points"),style:a},Object(K.c)(t))}),Uc=Object(c.b)(function(e){return{backgroundColor:Object(Qr.a)(e).backgroundColors.standard,programName:Object(i.i)(e).name}})(function(e){var t=e.programName,a={backgroundColor:e.backgroundColor};return n.a.createElement("span",{className:Object(O.b)("loyalty-widget__title"),style:a},n.a.createElement("span",{className:Object(O.b)("loyalty-widget__icon")}),t)}),Hc=function(e){var t=e.element,a=e.enabled,r=e.fontColor,c=e.hasCustomer,i=e.onWidgetClick,o=e.pagePosition;if(!a)return null;var l={color:r};return n.a.createElement(fn.a,{node:t},n.a.createElement(u,null,n.a.createElement(Xr,null,n.a.createElement("div",{className:Object(O.b)("loyalty-widget","loyalty-widget_position_".concat(o))},n.a.createElement(pn,null),n.a.createElement("div",{className:Object(O.b)("loyalty-widget__body"),style:l,onClick:i},n.a.createElement(Uc,null),c&&n.a.createElement(Vc,null))))))};Hc.displayName="LoyaltyWidgetPortal";var Wc=Object(c.b)(function(e){var t=Object(Qr.a)(e);return{enabled:t.enabled,fontColor:t.fontColor,hasCustomer:Boolean(Object(l.j)(e)),pagePosition:t.pagePosition}},{onWidgetClick:S.b})(Hc),qc=Object(I.createSelector)(A.k,function(e,t){return t},function(e,t){var a=Number(t);return isNaN(a)?null:Math.round(a/100)*e}),Yc=function(e){return e.points?n.a.createElement(fn.a,{node:e.element},"".concat(e.points)):null};Yc.displayName="PointsForPortal";var Gc=Object(c.b)(function(e,t){return{points:qc(e,t.value)}})(Yc),zc=function(e){return n.a.createElement(fn.a,{node:e.element},"".concat(e.points))};zc.displayName="PointsForRulePortal";var Xc=Object(c.b)(function(e,t){return{points:function(){switch(t.value){case"signup":return Object(A.r)(e);default:return 0}}()}})(zc),Jc=function(e){return n.a.createElement(fn.a,{node:e.element},Object(K.c)(e.points))};Jc.displayName="PointsPortal";var $c=Object(c.b)(function(e,t){var a=t.value;return"cart"===a?{points:Object(Xn.a)(e)}:{points:Object(l.h)(e)["approved"===a||"pending"===a||"spent"===a||"total"===a||"lifetime"===a?a:"total"]}})(Jc),Zc=function(e){return e.productsOnPage},Qc=(Object(I.createSelector)(Zc,function(e){return e.allIds}),Object(I.createSelector)(Zc,function(e,t){return t},function(e,t){var a;return null!==(a=e.byId[t])&&void 0!==a?a:null})),ei=Object(I.createSelector)(Qc,A.k,function(e,t){return e?Math.round(e.price/100)*t:null}),ti=function(e){return e.points?n.a.createElement(fn.a,{node:e.element},"".concat(e.points)):null};ti.displayName="ProductPointsPortal";var ai=Object(c.b)(function(e,t){return{points:ei(e,t.productId)}})(ti);var ri=function(e){var t=function(e,t){if(null===t)return e.direct;var a=t in e?e[t]:void 0;return void 0===a?e.direct:a}(e.referralUrls,e.value);return n.a.createElement(fn.a,{node:e.element},t)};ri.displayName="ReferralUrlPortal";var ni=Object(c.b)(function(e){return{referralUrls:Object(Pe.a)(e)}})(ri);function ci(e){V.a.warn("Component '".concat(e,"' not available in your LoyaltyLion subscription, contact support@loyaltylion.com for more details."))}var ii=function(e){function t(){return Object(_.a)(this,t),Object(k.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(j.a)(t,[{key:"createPortals",value:function(){var e=this;return this.props.portalElements.map(function(t,a){var r=t.element;if(!(r instanceof Element))return V.a.error("Invalid attempt to portal element for selector: ".concat(t.attribute),{portalElement:t,fingerprintType:"message"}),null;switch(r.innerHTML="",t.attribute){case"account":return n.a.createElement(Nc,Object(Ae.a)({},t,{key:a}));case"points":return n.a.createElement($c,Object(Ae.a)({},t,{key:a}));case"referral-url":return n.a.createElement(ni,Object(Ae.a)({},t,{key:a}));case"loyaltyWidget":return n.a.createElement(Wc,Object(Ae.a)({},t,{key:a}));case"points-for":return n.a.createElement(Gc,Object(Ae.a)({},t,{key:a}));case"points-for-id":case"points-for-product-id":return n.a.createElement(ai,{element:t.element,key:a,productId:t.value});case"points-for-rule":return n.a.createElement(Xc,Object(Ae.a)({},t,{key:a}));case"checkoutSlider":return n.a.createElement(Bc,Object(Ae.a)({},t,{key:a}));case"history-table":return e.props.sdkComponentAdvancedEnabled?n.a.createElement(Wn,{element:t.element,key:a}):(ci(t.attribute),null);case"rules-list":return e.props.sdkComponentAdvancedEnabled?n.a.createElement(ic,{element:t.element,key:a}):(ci(t.attribute),null);case"rewards-list":return e.props.sdkComponentAdvancedEnabled?n.a.createElement(cc,{element:t.element,key:a}):(ci(t.attribute),null);case"claimed-rewards-list":return e.props.sdkComponentAdvancedEnabled?n.a.createElement(Gn,{element:t.element,key:a}):(ci(t.attribute),null);case"seamless-product-reward":return n.a.createElement(Zn,{element:t.element,productId:t.value,key:a});case"seamless-product-reward-widget":return e.props.sdkComponentInCartRewardsEnabled?n.a.createElement(nc,Object(Ae.a)({},t,{key:a})):(ci(t.attribute),null);case"current-tier-name":return n.a.createElement(sc,Object(Ae.a)({},t,{key:a}));case"tier-overview":return n.a.createElement(Oc,Object(Ae.a)({},t,{key:a}));case"tier-benefits-compare":return n.a.createElement(fc,Object(Ae.a)({},t,{key:a}));case"tier-rewards-compare":return n.a.createElement(yc,Object(Ae.a)({},t,{key:a}));case"tier-rules-compare":return n.a.createElement(wc,Object(Ae.a)({},t,{key:a}));case"powered-by":return n.a.createElement(Yn,{element:t.element,key:a});case"integrated-page":return e.props.integratedPageEnabled?n.a.createElement(Hn,Object(Ae.a)({},t,{key:a})):(ci(t.attribute),null);default:return V.a.error("Unable to find component for portal element: ".concat(t.attribute),{portalElement:t}),null}}).filter(function(e){return e})}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,this.createPortals())}}]),t}(n.a.PureComponent);Object(h.a)(ii,"displayName","PortalContainer");t.default=function(e){var t=e.portalElements,a=Object(c.c)(i.a),r=a.sdkComponentAdvanced,o=a.sdkComponentInCartRewards,l=a.integratedPage,s=!Object(c.c)(Qr.b);return n.a.createElement(n.a.Fragment,null,n.a.createElement(ii,{portalElements:t,sdkComponentAdvancedEnabled:r,sdkComponentInCartRewardsEnabled:o,integratedPageEnabled:l}),n.a.createElement(Jr,null),s&&n.a.createElement(pn,null))}}}]);